[{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"http://mkdiro-o.github.io/phylobar/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"http://mkdiro-o.github.io/phylobar/articles/atlas.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Tipping Points in the Atlas 1006 Dataset","text":"begin loading mouse diet study data, stored remotely can loaded R phyloseq object. Next, load atlas1006 dataset. simplicity, focus samples r DNA extraction method transform abundances compositional form (sample sums 1). naive attempt build taxonomy-based tree can fail, duplicate names across different levels taxonomy may result loops. address , add level-specific prefixes (e.g., p_ phylum, f_ family), ensuring ancestor descendant nodes unique labels. valid tree abundance matrix, can generate phylobar plot. , samples arranged along x-axis, stacked bars representing taxonomic abundances, aligned corresponding branches tree. full dataset complex, can simplify visualization subsampling representative samples. preserves main conclusions reducing visual clutter. default, subset_cluster() function subsets samples close cut hierarchical clustering tree’s centroids. Alternatively, setting method = \"medoid\" choose representatives using KK-medoids according Bray-Curtis distance. result shown , though interpretation focus hierarchical clustering version.","code":"data(atlas1006) pseq3 <- atlas1006 |>     subset_samples(DNA_extraction_method == \"r\") |>     transform(transform = \"compositional\") tree <- taxonomy_to_tree(tax_table(pseq3)) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 128  #> Found number of nodes: m = 23  #>   FATAL: nodes and tips should appear only once in the 2nd column of 'edge' #>   FATAL: the root node should not appear in the 2nd column of 'edge' #> Done. taxa <- tax_table(pseq3) taxa <- cbind(Kingdom = \"Bacteria\", taxa) taxa <- phylobar::add_prefix(taxa)  tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 130  #> Found number of nodes: m = 31  #> Done. x <- t(otu_table(pseq3)) phylobar(x, tree, sample_show_all = FALSE, rel_width = 0.2) x_sub <- subset_cluster(x) x_sub <- x_sub[, colSums(x_sub) > 0]  leaves_to_keep <- intersect(tree$tip.label, colnames(x_sub)) filtered_tree <- drop.tip(tree, setdiff(tree$tip.label, leaves_to_keep)) phylobar(x_sub, filtered_tree) x_sub_bc <- subset_cluster(x, method = \"medoid\") x_sub_bc <- x_sub[, colSums(x_sub) > 0]  leaves_to_keep <- intersect(tree$tip.label, colnames(x_sub_bc)) filtered_tree <- drop.tip(tree, setdiff(tree$tip.label, leaves_to_keep)) phylobar(x_sub_bc, filtered_tree)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/atlas.html","id":"interpretation","dir":"Articles","previous_headings":"","what":"Interpretation","title":"Tipping Points in the Atlas 1006 Dataset","text":"many interesting patterns atlas dataset revealing distinct patterns human intestinal. example, Enterobacter aerogenes appears across broad range samples, generally low relative abundance. one sample shows notable representation, creating narrow band stacked barplot. patchy distribution characteristic opportunistic conditionally rare taxa, may present many individuals rarely dominate community structure. patterns previously described examples bimodal “tipping element” behavior, taxon abundant hosts nearly absent others. (https://pmc.ncbi.nlm.nih.gov/articles/PMC4102116/pdf/ncomms5344.pdf)  Next, screenshot highlights dominance Firmicutes (yellow) Bacteroidetes (purple) human gut microbiome. two phyla prevalent across nearly samples, relative proportions vary widely. samples Firmicutes-dominant, others Bacteroidetes-dominant. variability reflects complex interplay host genetics, diet, environmental factors shape gut microbiome.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/atlas.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Tipping Points in the Atlas 1006 Dataset","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.7.3 #>  #> Matrix products: default #> BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] microbiome_1.31.4 ggplot2_4.0.1     phyloseq_1.53.0   phylobar_0.99.0   #> [5] ape_5.8-1         BiocStyle_2.37.1  #>  #> loaded via a namespace (and not attached): #>  [1] ade4_1.7-23         tidyselect_1.2.1    dplyr_1.1.4         #>  [4] farver_2.1.2        Biostrings_2.77.2   S7_0.2.1            #>  [7] fastmap_1.2.0       digest_0.6.39       lifecycle_1.0.5     #> [10] cluster_2.1.8.1     survival_3.8-3      magrittr_2.0.4      #> [13] compiler_4.5.2      rlang_1.1.7         sass_0.4.10         #> [16] tools_4.5.2         igraph_2.2.1        yaml_2.3.12         #> [19] data.table_1.18.0   knitr_1.51          phangorn_2.12.1     #> [22] htmlwidgets_1.6.4   plyr_1.8.9          RColorBrewer_1.1-3  #> [25] Rtsne_0.17          withr_3.0.2         purrr_1.2.1         #> [28] BiocGenerics_0.55.1 desc_1.4.3          grid_4.5.2          #> [31] stats4_4.5.2        multtest_2.65.0     biomformat_1.37.0   #> [34] Rhdf5lib_1.31.0     scales_1.4.0        iterators_1.0.14    #> [37] MASS_7.3-65         dichromat_2.0-0.1   cli_3.6.5           #> [40] rmarkdown_2.30      vegan_2.7-2         crayon_1.5.3        #> [43] ragg_1.5.0          generics_0.1.4      otel_0.2.0          #> [46] reshape2_1.4.5      cachem_1.1.0        rhdf5_2.53.5        #> [49] stringr_1.6.0       splines_4.5.2       parallel_4.5.2      #> [52] BiocManager_1.30.26 XVector_0.49.1      vctrs_0.7.0         #> [55] Matrix_1.7-4        jsonlite_2.0.0      bookdown_0.45       #> [58] IRanges_2.43.5      S4Vectors_0.47.4    systemfonts_1.3.1   #> [61] foreach_1.5.2       tidyr_1.3.2         jquerylib_0.1.4     #> [64] glue_1.8.0          pkgdown_2.1.3       codetools_0.2-20    #> [67] stringi_1.8.7       gtable_0.3.6        quadprog_1.5-8      #> [70] tibble_3.3.1        pillar_1.11.1       htmltools_0.5.9     #> [73] Seqinfo_0.99.2      rhdf5filters_1.21.0 R6_2.6.1            #> [76] textshaping_1.0.4   evaluate_1.0.5      lattice_0.22-7      #> [79] Biobase_2.69.1      bslib_0.9.0         Rcpp_1.1.1          #> [82] fastmatch_1.1-6     nlme_3.1-168        permute_0.9-8       #> [85] mgcv_1.9-3          xfun_0.55           fs_1.6.6            #> [88] pkgconfig_2.0.3"},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"block loads relevant packages. use tidyverse packages preprocessing. Next, load data, organized phyloseq object slots phylogenetic tree, sample metadata, sample-level abundances.","code":"library(ape) library(dplyr) library(phylobar) library(tibble) library(tidyr) f <- tempfile() download.file(\"zenodo.org/records/17179980/files/zhang2023-ps.rds\", f) # will be replaced by ExperimentHub package, CancerOralMicrobiome ps <- readRDS(f)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"sample-level-analysis","dir":"Articles","previous_headings":"","what":"Sample-Level Analysis","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"now begin sample-level analysis. original dataset includes 1103 samples. simplify visualization, subset 100 representative samples chosen clustering K=100K = 100, implemented subset_cluster. subsetted data, rows correspond representative samples columns correspond OTU abundances. filter OTUs, One issue two OTUs now never appear among visualized samples. Let’s add small pseudocount make sure leaf node least mass.","code":"keep_ix <- rowMeans(otu_table(ps) > 0) > 0.01 ps <- prune_taxa(taxa_names(ps)[keep_ix], ps) x_mat <- t(otu_table(ps)) x_mat <- subset_cluster(x_mat, k = 100) x_mat[1, which(colSums(x_mat) == 0)] <- .00001 x_mat <- x_mat / rowSums(x_mat)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"sample-order","dir":"Articles","previous_headings":"Sample-Level Analysis","what":"Sample order","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"default, phylobar orders samples stacked bar plot according sample similarity. creates clean visualizations, fails address primary interest: variation community composition relates mucositis. Therefore, instead order samples mucositis severity patients gathered. block computes patient-level averages mucositis severity organizes samples first patient severity , within patient, time relative treatment initiation. Although ordering includes every sample dataset, plots use representative subset clustering step. finalize ordering subsetting sample order accordingly.","code":"sample_order <- data.frame(sample_data(ps)) |>     rownames_to_column(\"sample\") |>     group_by(id) |>     mutate(mean_mucositis = mean(mucositis)) |>     ungroup() |>     arrange(mean_mucositis, timediff) |>     pull(sample) row_ix <- sample_order[sample_order %in% rownames(x_mat)] col_ix <- hclust(dist(t(x_mat)))$order"},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"visualization","dir":"Articles","previous_headings":"Sample-Level Analysis","what":"Visualization","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"reorganized matrix used input phylobar. Samples right stacked bar severe mucositis average. use argument sample_show_fall = FALSE use custom ordering defined . sample_label_space = 75 argument gives bit extra vertical space sample labels, bit longer usual.","code":"phylobar(     x_mat[row_ix, col_ix],     phy_tree(ps),     width = 900,     hclust_order = FALSE,     sample_font_size = 6,     sample_label_space = 75 )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"interpretation","dir":"Articles","previous_headings":"Sample-Level Analysis","what":"Interpretation","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"highlight interesting findings using screenshots interactive plots. example, tallest bar far left one 16 (1103) samples 10 reads OTU 200, fact dominated OTU 200. suggests possible contamination quality-control issues. questionable OTU seems dominate one samples. Next, highlight two phylogenetic subtrees explore associations mucositis severity. subtree labeled purple (descendants node 0.859.2), higher abundance appears associated lower severity – purples bars larger left hand side stacked barplot. contrast, green subtree (descendants node 0.948.4), higher abundances associated higher severity. high-level phylogenetic groups seem associated mucositis severity. Next, collapse subtrees, resulting smaller tree layout letting us focus remaining phylogenetic groups. highlight bar (red) large values one severe mucositis patients. associated strain, OTU0910, shows high abundance relatively small number patients, patients tend experience worse average mucositis. collapsing parts tree, can study patterns isolated leaves without losing context entire tree.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"temporal-analysis","dir":"Articles","previous_headings":"","what":"Temporal Analysis","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"example visualizes stacked bars sample. However, might interested temporal trends averaged across samples—example, microbiome community structures change course treatment among people vs. less severe mucositis. next part, ’ll create streamgraph alternative stacked bars , stream defined time relative start treatment.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"streamgraph-helpers","dir":"Articles","previous_headings":"Temporal Analysis","what":"Streamgraph helpers","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"helper function computes kernel smoothing abundances species time. consider windows size two days take average across patients within window. final Gaussian kernel averaging applied smooth across adjacent windows. block converts original phyloseq object pair data frames, since format easier manipulate dplyr. also compute average mucositis score individual, identified ID column. derived feature useful understanding disease severity. alternative analysis also consider latent class grouping, discussed Zhang et al. (2023).","code":"smooth_time_series <- function(df, time_col = \"timediff\", pseudocount = 1, round_degree = 2, bandwidth = 5) {     # Round timediffs     df <- df |>         mutate(time_bin = round_degree * round(.data[[time_col]] / round_degree)) |>         arrange(time_bin) |>         group_by(time_bin) |>         summarise(             value = (sum(value) + pseudocount) / (n() + pseudocount)         )      # Fill gaps with 0     tibble(time_bin = seq(min(df$time_bin), max(df$time_bin), by = round_degree)) |>         left_join(df, by = \"time_bin\") |>         mutate(value = replace_na(value, 0)) |>         reframe(             smooth_value = ksmooth(time_bin, value, \"normal\", bandwidth, n.points = n())$y,             time_bin = ksmooth(time_bin, value, \"normal\", bandwidth, n.points = n())$x         ) } x_mat <- t(otu_table(ps)) |>     data.frame() |>     rownames_to_column(\"sample\") metadata <- sample_data(ps) |>     data.frame() |>     rownames_to_column(\"sample\") |>     group_by(id) |>     mutate(mean_mucositis = mean(mucositis))"},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"input-data-preparation","dir":"Articles","previous_headings":"Temporal Analysis","what":"Input data preparation","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"now reshape data long-format can apply smoothing function separately across species (feature data ) disease severity level. Several patients late follow-measurements, focus within 55 days treatment. result, x_smooth, applies kernel smoothing separately mroe vs. less severe mucositis cases, combines results single matrix—first grouped severity, sorted time. allows us study two trends within single stacked bar plot.","code":"x_long_format <- x_mat |>     left_join(metadata, by = \"sample\") |>     filter(between(timediff, -5, 55)) |>     select(id, timediff, mean_mucositis, starts_with(\"OTU\")) |>     pivot_longer(starts_with(\"O\"), names_to = \"feature\", values_to = \"value\")  x_smooth <- x_long_format |>     group_by(feature, severity = if_else(mean_mucositis > 3.5, \"S\", \"NS\")) |>     group_modify(~ smooth_time_series(.x)) |>     unite(row, time_bin, severity, sep = \"\") |>     pivot_wider(names_from = feature, values_from = smooth_value) |>     column_to_rownames(\"row\") x_smooth <- x_smooth / rowSums(x_smooth)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"visualization-1","dir":"Articles","previous_headings":"Temporal Analysis","what":"Visualization","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"can now create phylobar visualization, using phylogenetic tree . x-axis labels indicate severity time window. severe cases shown left side figure.","code":"phylobar(     x_smooth,     phy_tree(ps),     width = 900,     hclust_order = FALSE )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"interpretation-1","dir":"Articles","previous_headings":"Temporal Analysis","what":"Interpretation","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"Browsing across different phylogenetic groups, see descendants 0.538 abundant early time points patients severe mucositis. higher lower severity groups, however, abundance subtree decreases time. contrast, OTU0911 remains roughly stable across groups. final time windows lower severity group, appears become slightly abundant, though may artifact averaging smaller number samples available 55 days treatment start. overview phylobar streamgraph, showing high-level taxonomic groups differential trajectories across high low severity groups. Interacting next stacked bars, can identify several individual OTUs interest. example, OTU0307 (highlighted purple) becomes abundant later time points, especially among patients low mucositis. represent candidate species designing therapy aimed managing mucositis. OTU0297 (green) appears briefly midway treatment recovery among low-severity cases, illustrating transient effects can arise microbiome data. Finally, OTU0943 appears slightly abundant among lower severity, though effect tentative. zoomed phylobar streamgraph, focusing OTUs interest. observations emerged minutes interacting phylobar visualization. highlights exploratory potential approach shows dataset can viewed multiple phylogenetic resolutions uncover biologically meaningful trends.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Oral Microbiome and Mucositis Severity in Cancer Patients","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: Australia/Melbourne #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #>  [1] tidyr_1.3.1       tibble_3.3.0      phylobar_0.99.0   phangorn_2.12.1   #>  [5] purrr_1.1.0       htmlwidgets_1.6.4 phyloseq_1.52.0   dplyr_1.1.4       #>  [9] ape_5.8-1         BiocStyle_2.36.0  #>  #> loaded via a namespace (and not attached): #>  [1] ade4_1.7-23             tidyselect_1.2.1        farver_2.1.2            #>  [4] Biostrings_2.76.0       S7_0.2.0                fastmap_1.2.0           #>  [7] digest_0.6.37           lifecycle_1.0.4         cluster_2.1.8.1         #> [10] survival_3.8-3          magrittr_2.0.4          compiler_4.5.1          #> [13] rlang_1.1.6             sass_0.4.10             tools_4.5.1             #> [16] igraph_2.2.0            yaml_2.3.10             data.table_1.17.8       #> [19] knitr_1.50              plyr_1.8.9              RColorBrewer_1.1-3      #> [22] withr_3.0.2             BiocGenerics_0.54.1     desc_1.4.3              #> [25] grid_4.5.1              stats4_4.5.1            multtest_2.64.0         #> [28] biomformat_1.36.0       Rhdf5lib_1.30.0         ggplot2_4.0.0           #> [31] scales_1.4.0            iterators_1.0.14        MASS_7.3-65             #> [34] cli_3.6.5               rmarkdown_2.30          vegan_2.7-2             #> [37] crayon_1.5.3            ragg_1.5.0              generics_0.1.4          #> [40] rstudioapi_0.17.1       httr_1.4.7              reshape2_1.4.4          #> [43] cachem_1.1.0            rhdf5_2.52.1            stringr_1.5.2           #> [46] splines_4.5.1           parallel_4.5.1          BiocManager_1.30.26     #> [49] XVector_0.48.0          vctrs_0.6.5             Matrix_1.7-4            #> [52] jsonlite_2.0.0          bookdown_0.45           IRanges_2.42.0          #> [55] S4Vectors_0.46.0        systemfonts_1.3.1       foreach_1.5.2           #> [58] jquerylib_0.1.4         glue_1.8.0              pkgdown_2.1.3           #> [61] codetools_0.2-20        stringi_1.8.7           gtable_0.3.6            #> [64] GenomeInfoDb_1.44.3     UCSC.utils_1.4.0        quadprog_1.5-8          #> [67] pillar_1.11.1           htmltools_0.5.8.1       rhdf5filters_1.20.0     #> [70] GenomeInfoDbData_1.2.14 R6_2.6.1                textshaping_1.0.4       #> [73] evaluate_1.0.5          lattice_0.22-7          Biobase_2.68.0          #> [76] bslib_0.9.0             Rcpp_1.1.0              fastmatch_1.1-6         #> [79] nlme_3.1-168            permute_0.9-8           mgcv_1.9-3              #> [82] xfun_0.53               fs_1.6.6                pkgconfig_2.0.3"},{"path":"http://mkdiro-o.github.io/phylobar/articles/customizing_files.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Customizing Style in phylobar","text":"Phylobar draws phylogenetic tree alongside stacked bar chart. vignette shows customize visual style: text sizes, color palettes, layout ratios, legend placement, . use small random dataset: function signature key styling parameters explore: palette: colors used painted subtrees (stacked bars) width, height: widget size pixels sample_font_size, sample_label_margin, sample_label_space sample_magnify, sample_show_all rel_width, rel_height, rel_space legend_mode, legend_x_start, legend_spacing hclust_order: optional hierarchical reordering rows/columns Internally, phylobar() ensures tree node labels abundance matrix row/column names. ’re missing, helper check_inputs() creates sensible defaults (e.g., sample_1, sample_2).","code":"library(ape) library(phylobar)  set.seed(1) tree <- rtree(20) samples <- matrix(rpois(100 * 20, 1), nrow = 100, ncol = 20)  phylobar(samples, tree)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/customizing_files.html","id":"color-palette","dir":"Articles","previous_headings":"","what":"Color Palette","title":"Customizing Style in phylobar","text":"palette provided, phylobar uses default set six colors. possible supply vector hex colors R color names.","code":"# Custom qualitative palette (as many colors as you want; repeats if needed) my_palette <- c(     \"#4E79A7\", \"#F28E2B\", \"#E15759\",     \"#76B7B2\", \"#59A14F\", \"#EDC948\" ) phylobar(samples, tree, palette = my_palette)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/customizing_files.html","id":"widget-size","dir":"Articles","previous_headings":"","what":"Widget Size","title":"Customizing Style in phylobar","text":"default widget adapts container. Fix size :","code":"phylobar(samples, tree,     width = 800,     height = 500 )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/customizing_files.html","id":"sample-label-styling","dir":"Articles","previous_headings":"","what":"Sample Label Styling","title":"Customizing Style in phylobar","text":"Control sample label font size, spacing, hover magnification.","code":"phylobar(samples, tree,     width = 800, height = 500,     sample_font_size = 10,     sample_label_margin = 10, # space between labels and bars     sample_label_space = 100, # reserved margin for labels     sample_magnify = 1.3, # how much to enlarge labels on hover     sample_show_all = TRUE )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/customizing_files.html","id":"tree-bar-layout-ratio","dir":"Articles","previous_headings":"","what":"Tree-bar Layout Ratio","title":"Customizing Style in phylobar","text":"Change much horizontal vertical space tree occupies: rel_width: fraction total width reserved tree panel (default 0.4) rel_height: fraction total height tree panel (default 0.85) rel_space: pixels tree bar panels (default 10)","code":"phylobar(     samples, tree,     width = 800, height = 500,     sample_label_space = 100,     sample_magnify = 1.3,     rel_width = 0.2, # narrower tree     rel_height = 0.70, # shorter tree (more space for legend)     rel_space = 14 # larger gap between panels )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/customizing_files.html","id":"legend-placement","dir":"Articles","previous_headings":"","what":"Legend Placement","title":"Customizing Style in phylobar","text":"Choose whether painted subtree labels appear separate legend (legend_mode = TRUE, default) placed inside tree (legend_mode = FALSE). legend_x_start legend_spacing can also adjusted control legen position.","code":"# Legend below the tree (default) phylobar(     samples, tree,     width = 800, height = 500,     sample_label_space = 100,     sample_magnify = 1.3,     legend_mode = TRUE,     legend_x_start = 20, # horizontal start in pixels     legend_spacing = 20 # vertical spacing between legend items in pixels ) # Put labels inside the tree instead of a separate legend phylobar(     samples, tree,     width = 800, height = 500,     sample_label_space = 100,     sample_magnify = 1.3,     legend_mode = FALSE,     legend_x_start = 20, # horizontal start in pixels     legend_spacing = 20 # vertical spacing between legend items in pixels )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/customizing_files.html","id":"optional-hierarchical-reordering","dir":"Articles","previous_headings":"","what":"Optional Hierarchical Reordering","title":"Customizing Style in phylobar","text":"hclust_order = TRUE (default) reorders samples/features hierarchical clustering, can make patterns visible. Turn preserve original order:","code":"# Keep the input order as-is phylobar(     samples, tree,     width = 800, height = 500,     sample_label_space = 100,     sample_magnify = 1.3,     hclust_order = FALSE )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/customizing_files.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Customizing Style in phylobar","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.7.3 #>  #> Matrix products: default #> BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] phylobar_0.99.0  ape_5.8-1        BiocStyle_2.37.1 #>  #> loaded via a namespace (and not attached): #>  [1] Matrix_1.7-4        jsonlite_2.0.0      compiler_4.5.2      #>  [4] BiocManager_1.30.26 Rcpp_1.1.1          parallel_4.5.2      #>  [7] cluster_2.1.8.1     jquerylib_0.1.4     systemfonts_1.3.1   #> [10] textshaping_1.0.4   yaml_2.3.12         fastmap_1.2.0       #> [13] lattice_0.22-7      R6_2.6.1            generics_0.1.4      #> [16] igraph_2.2.1        knitr_1.51          htmlwidgets_1.6.4   #> [19] bookdown_0.45       desc_1.4.3          bslib_0.9.0         #> [22] rlang_1.1.7         fastmatch_1.1-6     cachem_1.1.0        #> [25] xfun_0.55           quadprog_1.5-8      fs_1.6.6            #> [28] sass_0.4.10         otel_0.2.0          cli_3.6.5           #> [31] pkgdown_2.1.3       magrittr_2.0.4      phangorn_2.12.1     #> [34] digest_0.6.39       grid_4.5.2          lifecycle_1.0.5     #> [37] nlme_3.1-168        vctrs_0.7.0         evaluate_1.0.5      #> [40] codetools_0.2-20    ragg_1.5.0          purrr_1.2.1         #> [43] rmarkdown_2.30      pkgconfig_2.0.3     tools_4.5.2         #> [46] htmltools_0.5.9"},{"path":"http://mkdiro-o.github.io/phylobar/articles/diet_analysis.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Differences in the Community Composition due to Diet","text":"begin loading mouse diet study data, stored remotely can loaded R phyloseq object. prepare data visualization, first convert phyloseq object MicrobiomeStat object using mStat_convert_phyloseq_to_data_obj(). enables us apply DESeq2 normalization, corrects sequencing depth differences across samples. transpose normalized feature matrix rows correspond taxa columns samples, expected phylobar(). Unlike relative-abundance normalization, DESeq2 constrain sample totals equal one. distinction highlights flexibility functions, since phylobar can accommodate compositional non-compositional inputs. normalization, transpose feature matrix rows correspond taxa columns samples, required phylobar(). Next, construct taxonomy-based tree available annotations. ensure ancestor descendant nodes remain uniquely identifiable, add prefixes taxonomic level (e.g., p_ phylum, f_ family). Without step, different levels can share names, prevent taxonomy converted valid tree. prefixed taxonomy table passed taxonomy_to_tree(), producing hierarchical tree serve backbone visualization. point, two aligned objects ready visualization: normalized abundance matrix (x) taxonomy-derived tree (tree). now pass objects phylobar(). resulting plot shows stacked bar charts taxa abundances, aligned hierarchical tree structure.","code":"data(\"dietswap\", package = \"microbiome\") diet_temp <- subset_samples(dietswap, timepoint == 1) diet <- subset_taxa(diet_temp, taxa_sums(diet_temp) > 0) diet_mstat <- mStat_convert_phyloseq_to_data_obj(diet) diet_mstat <- mStat_normalize_data(diet_mstat, \"DESeq\") x <- t(diet_mstat$data.obj.norm$feature.tab) taxa <- tax_table(diet) |>     phylobar::add_prefix() taxa <- cbind(Kingdom = \"k_Bacteria\", taxa) tree <- taxonomy_to_tree(taxa) phylobar(x, tree, width = 800)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/diet_analysis.html","id":"interpretation","dir":"Articles","previous_headings":"","what":"Interpretation","title":"Differences in the Community Composition due to Diet","text":"showcase several notable patterns using screenshots interactive plots: mice display co-dominance Firmicutes (purple) Bacteroidetes (teal), sample_52 shows clear Firmicutes dominance, underscoring dietary interventions can shift balance two phyla.  Next, observe abundance Clostridium cluster IV family acros samples. variability abundance suggests Clostridium cluster IV widespread, contribution community structure differs across individuals conditions.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/diet_analysis.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Differences in the Community Composition due to Diet","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.7.3 #>  #> Matrix products: default #> BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] MicrobiomeStat_1.4.1        tibble_3.3.1                #>  [3] rlang_1.1.7                 DESeq2_1.49.4               #>  [5] SummarizedExperiment_1.39.2 Biobase_2.69.1              #>  [7] MatrixGenerics_1.21.0       matrixStats_1.5.0           #>  [9] GenomicRanges_1.61.5        Seqinfo_0.99.2              #> [11] IRanges_2.43.5              S4Vectors_0.47.4            #> [13] BiocGenerics_0.55.1         generics_0.1.4              #> [15] phyloseq_1.53.0             phylobar_0.99.0             #> [17] BiocStyle_2.37.1            #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3  jsonlite_2.0.0      magrittr_2.0.4      #>   [4] farver_2.1.2        nloptr_2.2.1        rmarkdown_2.30      #>   [7] fs_1.6.6            ragg_1.5.0          vctrs_0.7.0         #>  [10] multtest_2.65.0     minqa_1.2.8         ggtree_3.99.0       #>  [13] htmltools_0.5.9     S4Arrays_1.9.1      Rhdf5lib_1.31.0     #>  [16] SparseArray_1.9.1   rhdf5_2.53.5        gridGraphics_0.5-1  #>  [19] sass_0.4.10         bslib_0.9.0         htmlwidgets_1.6.4   #>  [22] desc_1.4.3          plyr_1.8.9          cachem_1.1.0        #>  [25] uuid_1.2-1          igraph_2.2.1        lifecycle_1.0.5     #>  [28] iterators_1.0.14    pkgconfig_2.0.3     Matrix_1.7-4        #>  [31] R6_2.6.1            fastmap_1.2.0       clue_0.3-66         #>  [34] rbibutils_2.4       digest_0.6.39       numDeriv_2016.8-1.1 #>  [37] aplot_0.2.9         ggnewscale_0.5.2    spatial_7.3-18      #>  [40] patchwork_1.3.2     textshaping_1.0.4   vegan_2.7-2         #>  [43] abind_1.4-8         mgcv_1.9-3          compiler_4.5.2      #>  [46] withr_3.0.2         pander_0.6.6        S7_0.2.1            #>  [49] BiocParallel_1.43.4 MASS_7.3-65         rappdirs_0.3.4      #>  [52] DelayedArray_0.35.3 biomformat_1.37.0   fBasics_4041.97     #>  [55] permute_0.9-8       tools_4.5.2         otel_0.2.0          #>  [58] ape_5.8-1           glue_1.8.0          quadprog_1.5-8      #>  [61] stabledist_0.7-2    nlme_3.1-168        rhdf5filters_1.21.0 #>  [64] grid_4.5.2          cluster_2.1.8.1     reshape2_1.4.5      #>  [67] ade4_1.7-23         gtable_0.3.6        tidyr_1.3.2         #>  [70] data.table_1.18.0   XVector_0.49.1      rmutil_1.1.10       #>  [73] foreach_1.5.2       pillar_1.11.1       stringr_1.6.0       #>  [76] yulab.utils_0.2.1   splines_4.5.2       dplyr_1.1.4         #>  [79] treeio_1.33.0       lattice_0.22-7      survival_3.8-3      #>  [82] tidyselect_1.2.1    locfit_1.5-9.12     Biostrings_2.77.2   #>  [85] knitr_1.51          reformulas_0.4.3.1  bookdown_0.45       #>  [88] ggtreeExtra_1.19.1  xfun_0.55           timeDate_4051.111   #>  [91] stringi_1.8.7       lazyeval_0.2.2      ggfun_0.2.0         #>  [94] yaml_2.3.12         boot_1.3-32         evaluate_1.0.5      #>  [97] codetools_0.2-20    timeSeries_4041.111 BiocManager_1.30.26 #> [100] ggplotify_0.1.3     cli_3.6.5           rpart_4.1.24        #> [103] systemfonts_1.3.1   Rdpack_2.6.4        jquerylib_0.1.4     #> [106] dichromat_2.0-0.1   Rcpp_1.1.1          stable_1.1.6        #> [109] parallel_4.5.2      modeest_2.4.0       pkgdown_2.1.3       #> [112] ggplot2_4.0.1       lme4_1.1-38         phangorn_2.12.1     #> [115] tidytree_0.4.6      ggiraph_0.9.1       lmerTest_3.1-3      #> [118] scales_1.4.0        statip_0.2.3        purrr_1.2.1         #> [121] crayon_1.5.3        fastmatch_1.1-6"},{"path":"http://mkdiro-o.github.io/phylobar/articles/exporting.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Exporting to Vector Graphics Format","text":"identify interesting view, can share others? First, press Escape key freeze view, doesn’t respond mouse interactions. , always take screenshot, want preserve details (add notes within figure ), instead export Scalable Graphics (SVG), discussed vignette. work, need use Google Chrome install bookmarklet SVG Crowbar 2. ’ll illustrate process using simple randomly generatred tree .","code":"library(ape) library(phylobar)  tree <- rtree(20) samples <- matrix(rpois(100 * 20, 1), 100, 20) phylobar(samples, tree, width=800)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/exporting.html","id":"step-1-exporting-from-browser","dir":"Articles","previous_headings":"","what":"Step 1: Exporting from Browser","title":"Exporting to Vector Graphics Format","text":"bookmarklet installed, can press download phylobar figures Quarto Rmarkdown notebook. recording , pressed Escape painting blue subtree. move bookmarks bar without changing view. Clicking bookmarklet brings “SVG # (Download)” button can click, associated graphic appear Downloads folder. Note can scroll phylobar visualizations see buttons downloading plots.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/exporting.html","id":"step-2-open-in-editor","dir":"Articles","previous_headings":"","what":"Step 2: Open in Editor","title":"Exporting to Vector Graphics Format","text":"downloaded file ordinary SVG, means can edited image editor designed vector graphics. example, recording , open downloaded figure using Inkscape, free open source vector graphics editor. Notice components phylobar plot already organized layers.. example, layer barplot, sublayers sample, final sublayer taxa within samples. layer structure reflects original DOM structure created D3 visualization code. recording shows can navigate layer structure within Inkscape.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/exporting.html","id":"step-3-modify-and-save","dir":"Articles","previous_headings":"","what":"Step 3: Modify and Save","title":"Exporting to Vector Graphics Format","text":", edit want (e.g., add comment interesting pattern). able export formats might accessible others, e.g., one can embed slides add word document. recording , use layer structure shown previous snippet modify green subtree uses dashed (rather solid) lines link nodes. final version, export graphic PNG format.","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.7.3 #>  #> Matrix products: default #> BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] phylobar_0.99.0  ape_5.8-1        BiocStyle_2.37.1 #>  #> loaded via a namespace (and not attached): #>  [1] Matrix_1.7-4        jsonlite_2.0.0      compiler_4.5.2      #>  [4] BiocManager_1.30.26 Rcpp_1.1.1          parallel_4.5.2      #>  [7] cluster_2.1.8.1     jquerylib_0.1.4     systemfonts_1.3.1   #> [10] textshaping_1.0.4   yaml_2.3.12         fastmap_1.2.0       #> [13] lattice_0.22-7      R6_2.6.1            generics_0.1.4      #> [16] igraph_2.2.1        knitr_1.51          htmlwidgets_1.6.4   #> [19] bookdown_0.45       desc_1.4.3          bslib_0.9.0         #> [22] rlang_1.1.7         fastmatch_1.1-6     cachem_1.1.0        #> [25] xfun_0.55           quadprog_1.5-8      fs_1.6.6            #> [28] sass_0.4.10         otel_0.2.0          cli_3.6.5           #> [31] pkgdown_2.1.3       magrittr_2.0.4      phangorn_2.12.1     #> [34] digest_0.6.39       grid_4.5.2          lifecycle_1.0.5     #> [37] nlme_3.1-168        vctrs_0.7.0         evaluate_1.0.5      #> [40] codetools_0.2-20    ragg_1.5.0          purrr_1.2.1         #> [43] rmarkdown_2.30      pkgconfig_2.0.3     tools_4.5.2         #> [46] htmltools_0.5.9"},{"path":"http://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Working with phyloseq and TreeSummarizedExperiment versions of the Global Patterns Dataset","text":"","code":"library(ape) library(phylobar) library(phyloseq) library(miaViz) library(scater)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"phyloseq-inputs","dir":"Articles","previous_headings":"","what":"phyloseq Inputs","title":"Working with phyloseq and TreeSummarizedExperiment versions of the Global Patterns Dataset","text":"first study use phylobar phyloseq objects. block sets global pattern status subsets Chlamydia subtree. can extract relevant sample composition using otu_table accessor function.","code":"data(GlobalPatterns, package = \"phyloseq\") chlamydiae <- subset_taxa(GlobalPatterns, Phylum == \"Chlamydiae\") x_phylo <- t(otu_table(chlamydiae))"},{"path":"http://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"phylogenetic-tree-tree","dir":"Articles","previous_headings":"phyloseq Inputs","what":"Phylogenetic Tree Tree","title":"Working with phyloseq and TreeSummarizedExperiment versions of the Global Patterns Dataset","text":"first approach use phylogenetic tree support hierarchical interaction. tree can extracted phyloseq object using phy_tree. first subsetted chlamydia subtree. now samples without observed counts. Therefore, remove samples view. can now create phylobar plot.","code":"tree_phylo <- phy_tree(chlamydiae) x_phylo <- x_phylo[rowSums(x_phylo) > 0, ] x_phylo <- x_phylo / rowSums(x_phylo) phylobar(x_phylo, tree_phylo, width = 900)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"using-taxonomic-hierarchy","dir":"Articles","previous_headings":"phyloseq Inputs","what":"Using Taxonomic Hierarchy","title":"Working with phyloseq and TreeSummarizedExperiment versions of the Global Patterns Dataset","text":"creates type visualization using taxonomic hierarchy rather phylogeny. need problem-specific preprocessing deal fact ancestor descendant names look identical dataset. add_prefix helper ensures names distinct parents children adding taxonomic rank name. Now can create phylo tree object associated original taxonomy. Note binary tree, since several taxonomic categories descended single node.  Given new taxonomy earlier sample information, can now create phylobar plot.","code":"taxa <- tax_table(chlamydiae) |>     as.data.frame() taxa$ASV <- rownames(taxa) taxa <- phylobar::add_prefix(taxa) tax_tree <- taxonomy_to_tree(taxa) plot(tax_tree) phylobar(x_phylo, tax_tree, width = 900)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"treesummarizedexperiment-inputs","dir":"Articles","previous_headings":"","what":"TreeSummarizedExperiment Inputs","title":"Working with phyloseq and TreeSummarizedExperiment versions of the Global Patterns Dataset","text":"example comes miaViz documentation shows create stacked bar tree TreeSummarizedExperiment. ’ll filter species present least one percent samples. example ’ll use relative abundance transformation, left composition plot rather general stacked bar plot. Let’s keep taxes observed least one sample. also need filter tree reflect reduced subset taxa. inputs, can generate phylobar visualization. view didn’t subset chlamydia class, larger tree . hopefully ’s clear TreeSummarizedExperiment phyloseq can essentially used interchangeably constructing necessary inputs visualizations.","code":"data(GlobalPatterns, package = \"mia\") prev_species <- getPrevalent(GlobalPatterns, rank = \"Species\", detection = 0.01) GlobalPatterns_tse <- GlobalPatterns[     rowData(GlobalPatterns)$Species %in% prev_species, ] GlobalPatterns_tse <- transformAssay(     GlobalPatterns_tse,     method = \"relabundance\" ) x_tse <- t(assay(GlobalPatterns_tse, \"relabundance\")) x_tse <- x_tse[, colSums(x_tse) > 0] tree_tse <- rowTree(GlobalPatterns_tse) |>     keep.tip(colnames(x_tse)) phylobar(x_tse, tree_tse, width = 900) sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.7.3 #>  #> Matrix products: default #> BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] scater_1.37.0                   scuttle_1.19.0                  #>  [3] miaViz_1.17.9                   mia_1.17.9                      #>  [5] TreeSummarizedExperiment_2.17.1 Biostrings_2.77.2               #>  [7] XVector_0.49.1                  SingleCellExperiment_1.31.1     #>  [9] MultiAssayExperiment_1.35.9     SummarizedExperiment_1.39.2     #> [11] Biobase_2.69.1                  GenomicRanges_1.61.5            #> [13] Seqinfo_0.99.2                  IRanges_2.43.5                  #> [15] S4Vectors_0.47.4                BiocGenerics_0.55.1             #> [17] generics_0.1.4                  MatrixGenerics_1.21.0           #> [19] matrixStats_1.5.0               ggraph_2.2.2                    #> [21] ggplot2_4.0.1                   phyloseq_1.53.0                 #> [23] phylobar_0.99.0                 ape_5.8-1                       #> [25] BiocStyle_2.37.1                #>  #> loaded via a namespace (and not attached): #>   [1] splines_4.5.2               ggplotify_0.1.3             #>   [3] cellranger_1.1.0            tibble_3.3.1                #>   [5] polyclip_1.10-7             DirichletMultinomial_1.51.0 #>   [7] lifecycle_1.0.5             lattice_0.22-7              #>   [9] MASS_7.3-65                 SnowballC_0.7.1             #>  [11] magrittr_2.0.4              sass_0.4.10                 #>  [13] rmarkdown_2.30              jquerylib_0.1.4             #>  [15] yaml_2.3.12                 otel_0.2.0                  #>  [17] DBI_1.2.3                   RColorBrewer_1.1-3          #>  [19] ade4_1.7-23                 multcomp_1.4-28             #>  [21] abind_1.4-8                 quadprog_1.5-8              #>  [23] purrr_1.2.1                 fillpattern_1.0.2           #>  [25] yulab.utils_0.2.1           TH.data_1.1-4               #>  [27] tweenr_2.0.3                rappdirs_0.3.4              #>  [29] sandwich_3.1-1              ggrepel_0.9.6               #>  [31] tokenizers_0.3.0            irlba_2.3.5.1               #>  [33] tidytree_0.4.6              vegan_2.7-2                 #>  [35] rbiom_2.2.1                 parallelly_1.46.1           #>  [37] pkgdown_2.1.3               permute_0.9-8               #>  [39] DelayedMatrixStats_1.31.0   codetools_0.2-20            #>  [41] DelayedArray_0.35.3         ggtext_0.1.2                #>  [43] xml2_1.4.0                  ggforce_0.5.0               #>  [45] tidyselect_1.2.1            aplot_0.2.9                 #>  [47] farver_2.1.2                ScaledMatrix_1.17.0         #>  [49] viridis_0.6.5               jsonlite_2.0.0              #>  [51] BiocNeighbors_2.3.1         multtest_2.65.0             #>  [53] decontam_1.29.0             tidygraph_1.3.1             #>  [55] survival_3.8-3              iterators_1.0.14            #>  [57] emmeans_1.11.2-8            systemfonts_1.3.1           #>  [59] foreach_1.5.2               tools_4.5.2                 #>  [61] ggnewscale_0.5.2            treeio_1.33.0               #>  [63] ragg_1.5.0                  Rcpp_1.1.1                  #>  [65] glue_1.8.0                  gridExtra_2.3               #>  [67] SparseArray_1.9.1           BiocBaseUtils_1.11.2        #>  [69] xfun_0.55                   mgcv_1.9-3                  #>  [71] dplyr_1.1.4                 withr_3.0.2                 #>  [73] BiocManager_1.30.26         fastmap_1.2.0               #>  [75] rhdf5filters_1.21.0         bluster_1.19.0              #>  [77] digest_0.6.39               rsvd_1.0.5                  #>  [79] gridGraphics_0.5-1          R6_2.6.1                    #>  [81] estimability_1.5.1          textshaping_1.0.4           #>  [83] dichromat_2.0-0.1           tidyr_1.3.2                 #>  [85] data.table_1.18.0           DECIPHER_3.5.0              #>  [87] graphlayouts_1.2.2          htmlwidgets_1.6.4           #>  [89] S4Arrays_1.9.1              pkgconfig_2.0.3             #>  [91] gtable_0.3.6                S7_0.2.1                    #>  [93] janeaustenr_1.0.0           htmltools_0.5.9             #>  [95] bookdown_0.45               biomformat_1.37.0           #>  [97] scales_1.4.0                ggfun_0.2.0                 #>  [99] knitr_1.51                  uuid_1.2-1                  #> [101] tzdb_0.5.0                  reshape2_1.4.5              #> [103] coda_0.19-4.1               nlme_3.1-168                #> [105] cachem_1.1.0                zoo_1.8-15                  #> [107] rhdf5_2.53.5                stringr_1.6.0               #> [109] parallel_4.5.2              vipor_0.4.7                 #> [111] desc_1.4.3                  pillar_1.11.1               #> [113] grid_4.5.2                  vctrs_0.7.0                 #> [115] slam_0.1-55                 BiocSingular_1.25.0         #> [117] beachmat_2.25.5             xtable_1.8-4                #> [119] cluster_2.1.8.1             beeswarm_0.4.0              #> [121] evaluate_1.0.5              readr_2.1.5                 #> [123] mvtnorm_1.3-3               cli_3.6.5                   #> [125] compiler_4.5.2              rlang_1.1.7                 #> [127] crayon_1.5.3                tidytext_0.4.3              #> [129] plyr_1.8.9                  fs_1.6.6                    #> [131] ggbeeswarm_0.7.2            ggiraph_0.9.1               #> [133] stringi_1.8.7               viridisLite_0.4.2           #> [135] BiocParallel_1.43.4         lazyeval_0.2.2              #> [137] Matrix_1.7-4                hms_1.1.3                   #> [139] patchwork_1.3.2             sparseMatrixStats_1.21.0    #> [141] Rhdf5lib_1.31.0             gridtext_0.1.5              #> [143] igraph_2.2.1                memoise_2.0.1               #> [145] bslib_0.9.0                 ggtree_3.99.0               #> [147] phangorn_2.12.1             fastmatch_1.1-6             #> [149] readxl_1.4.5"},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"High-fat, high-sugar (HFHS) diets known profoundly alter gut microbiome, influencing microbial composition functional capacity. described Susin et al. (2020), effects diet gut microbiome evaluated 47 C57BL/6 female mice. mice fed either HFHS diet normal diet, fecal samples collected days 0, 1, 4, 7. Illumina MiSeq used generate 16S rRNA sequencing data, subsequently processed QIIME 1.9.0. vignette, use preprocessed dataset Kodikara et al. (2025). dataset can accessed GitHub repository LUPINE R package using command devtools::install_github(\"SarithaKodikara/LUPINE\"). , demonstrate apply phylobar package create phylogeny-aware visualizations HFHS diet study data. Specifically, walk tree construction generate visualizations reproduce key findings previous studies, including decreased relative abundance increase relative abundance (Jo et al. 2021, Yang et al. 2024).","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"why-phylogeny-aware-plots","dir":"Articles","previous_headings":"","what":"Why phylogeny-aware plots?","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"Static stacked bar plots often hide changes occur specific taxonomic levels. Phylogeny-aware plots maintain hierarchical structure, zooming level (example, class Bacteroidia family S24-7) lets see whether shifts local clade spread across multiple branches. supports exploratory analysis helps decide levels warrant downstream testing.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"following code block loads packages required analysis. Next, load HFHS dataset, stored LUPINE package HFHSdata. dataset stored list contains OTU tables mice fed either normal diet HFHS diet, along corresponding taxonomic annotations.","code":"library(phylobar)   # phylogeny-aware bar plots library(LUPINE)     # HFHS example dataset library(dplyr)      # data wrangling library(ape)        # phylogenetic tree manipulation library(stringr)    # string operations data(HFHSdata) normal <- HFHSdata$OTUdata_Normal hfhs <- HFHSdata$OTUdata_HFHS taxa <- HFHSdata$filtered_taxonomy"},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"taxonomy-based-tree-construction","dir":"Articles","previous_headings":"","what":"Taxonomy-based tree construction","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"begin constructing taxonomy-based tree taxonomic annotations provided dataset. taxonomy_to_tree function phylobar package used convert taxonomic data phylogenetic tree structure.","code":"tree <- taxa |>     select(-X1, X1) |>     mutate(         across(             everything(),             ~if_else(str_ends(., \"_\"), NA, .)         )     ) |>     taxonomy_to_tree()  checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 212  #> Found number of nodes: m = 80  #> Done."},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"diet-contrasts-on-day-7","dir":"Articles","previous_headings":"","what":"Diet contrasts on day 7","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"visualize effect diet mouse microbiome, focus samples collected day 7. samples expected show pronounced differences normal diet HFHS diet group (Kodikara et al. 2025). begin extracting relevant slices 3D arrays representing OTU tables diet groups. also rename samples indicate diet group (N normal diet H HFHS diet). Finally convert compositions visualize. Lets select Bacteroidia class dropdown see effect diet class.","code":"# Extract day 7 samples and rename normal_day7 <- normal[,, 4] rownames(normal_day7) <- str_replace(rownames(normal_day7), \"M_\", \"N\") hfhs_day7 <- hfhs[,, 4] rownames(hfhs_day7) <- str_replace(rownames(hfhs_day7), \"M_\", \"H\") # Combine the two datasets all_day7 <- rbind(normal_day7, hfhs_day7)  # Order samples and species using hierarchical clustering comp_norm <- normal_day7 comp_norm <- comp_norm / rowSums(comp_norm) sample_order1 <- hclust(dist(comp_norm))$order species_order <- hclust(dist(t(comp_norm)))$order  # Now order the HFHS samples comp_hfhs <- hfhs_day7 comp_hfhs <- comp_hfhs / rowSums(comp_hfhs) sample_order2 <- hclust(dist(comp_hfhs))$order  # Combine the sample orders sample_order <- c(rownames(normal_day7)[sample_order1], rownames(hfhs_day7)[sample_order2])  # Reorder the combined data x <- all_day7[sample_order, species_order] comp <- x / rowSums(x) colnames(comp) <- colnames(all_day7)[species_order] phylobar(comp, tree, hclust_order = FALSE, sample_font_size = 9)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"interpretation","dir":"Articles","previous_headings":"Diet contrasts on day 7","what":"Interpretation","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"Phylobar plot mouse microbiome day 7, comparing normal diet (N) HFHS diet (H). plot highlights relative abundances Bacteroidia class, known decrease response HFHS diet. shown Figure @ref(fig:fig1), relative abundance Bacteroidia decreases HFHS diet group compared normal diet group, consistent previous findings (Jo et al. 2021, Yang et al. 2024). Similarly, can visualize Firmicutes phylum observe increase relative abundance HFHS diet (Figure @ref(fig:fig2)). Phylobar plot mouse microbiome day 7, comparing normal diet (N) HFHS diet (H). plot highlights relative abundances Firmicutes phylum, known increase response HFHS diet.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"longitudinal-trajectories-within-hfhs","dir":"Articles","previous_headings":"","what":"Longitudinal trajectories within HFHS","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"explore longitudinal patterns HFHS diet group, visualized samples collected days 0, 1, 4, 7. allows us track microbiome composition changes time response HFHS diet. Samples deliberately sorted mouse time point, enabling us observe within-mouse changes across study period. important initial relative abundances can differ mice, aligning samples individual helps highlight true longitudinal shifts. now convert compositions visualize longitudinal data HFHS diet group.","code":"y <- hfhs[sample_order2, species_order, ] |>     aperm(c(1, 3, 2)) |>     matrix(nrow = nrow(hfhs)*dim(hfhs)[3] , ncol = ncol(hfhs))  rownames(y) <- apply(     expand.grid(c(0, 1, 4, 7), str_replace(rownames(hfhs),\"M_\",\"\")[sample_order2]),     1, paste, collapse = \"-\" ) comp <- y / rowSums(y) colnames(comp) <- colnames(hfhs)[species_order] phylobar(comp, tree, hclust_order = FALSE, sample_font_size = 9) # p <- phylobar( #     comp, tree, hclust_order = FALSE, #     width = 1200, height = 800, sample_font_size = 8 # ) # htmlwidgets::saveWidget( #     p, \"interactive_scatter.html\", selfcontained = TRUE # )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"interpretations","dir":"Articles","previous_headings":"Longitudinal trajectories within HFHS","what":"Interpretations","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"Even though variability mice high, can observe general decrease relative abundance S24-7 family (within Bacteroidetes phylum) time response HFHS diet (Figure @ref(fig:fig3)). pattern aligns previous findings indicating members S24-7 family sensitive dietary changes tend decrease abundance high-fat, high-sugar dietary conditions (Kodikara et al. 2025). Phylobar plot mouse microbiome HFHS diet. plot highlights relative abundances S24-7 family belong Bacteroidetes phylum, known decrease time response HFHS diet.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"alternative-sorting","dir":"Articles","previous_headings":"Longitudinal trajectories within HFHS","what":"Alternative Sorting","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"can create phylobar visualization first sorting time mouse. variation abundance within continguous blocks gives sense mouse--mouse variability, changes area left right side stacked bars gives sense change time within HFHS diet mice.","code":"time <- as.numeric(sub(\"-.*\", \"\", rownames(comp))) mouse <- factor(     sub(\".*-\", \"\", rownames(comp)),     levels = unique(sub(\".*-\", \"\", rownames(comp))) ) comp_sort <- comp[order(time, mouse), ] phylobar(comp_sort, tree, hclust_order = FALSE, sample_font_size = 9)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.7.3 #>  #> Matrix products: default #> BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] stringr_1.6.0    ape_5.8-1        dplyr_1.1.4      LUPINE_0.1.0     #> [5] phylobar_0.99.0  BiocStyle_2.37.1 #>  #> loaded via a namespace (and not attached): #>  [1] ade4_1.7-23           tidyselect_1.2.1      farver_2.1.2          #>  [4] S7_0.2.1              fastmap_1.2.0         pracma_2.4.6          #>  [7] digest_0.6.39         ROptSpace_0.2.4       lifecycle_1.0.5       #> [10] cluster_2.1.8.1       magrittr_2.0.4        compiler_4.5.2        #> [13] rlang_1.1.7           sass_0.4.10           tools_4.5.2           #> [16] igraph_2.2.1          yaml_2.3.12           data.table_1.18.0     #> [19] knitr_1.51            phangorn_2.12.1       rARPACK_0.11-0        #> [22] htmlwidgets_1.6.4     plyr_1.8.9            RColorBrewer_1.1-3    #> [25] influential_2.2.9     abind_1.4-8           BiocParallel_1.43.4   #> [28] withr_3.0.2           purrr_1.2.1           desc_1.4.3            #> [31] grid_4.5.2            e1071_1.7-16          ggplot2_4.0.1         #> [34] scales_1.4.0          iterators_1.0.14      MASS_7.3-65           #> [37] dichromat_2.0-0.1     cli_3.6.5             ellipse_0.5.0         #> [40] rmarkdown_2.30        ragg_1.5.0            generics_0.1.4        #> [43] rlist_0.4.6.2         otel_0.2.0            RSpectra_0.16-2       #> [46] reshape2_1.4.5        graphon_0.3.6         pbapply_1.7-4         #> [49] cachem_1.1.0          proxy_0.4-27          network_1.19.0        #> [52] parallel_4.5.2        BiocManager_1.30.26   matrixStats_1.5.0     #> [55] vctrs_0.7.0           Matrix_1.7-4          jsonlite_2.0.0        #> [58] bookdown_0.45         ggrepel_0.9.6         systemfonts_1.3.1     #> [61] foreach_1.5.2         tidyr_1.3.2           jquerylib_0.1.4       #> [64] glue_1.8.0            statnet.common_4.12.0 pkgdown_2.1.3         #> [67] codetools_0.2-20      mixOmics_6.33.0       stringi_1.8.7         #> [70] gtable_0.3.6          quadprog_1.5-8        tibble_3.3.1          #> [73] pillar_1.11.1         htmltools_0.5.9       R6_2.6.1              #> [76] textshaping_1.0.4     Rdpack_2.6.4          doParallel_1.0.17     #> [79] evaluate_1.0.5        NetworkDistance_0.3.6 lattice_0.22-7        #> [82] png_0.1-8             rbibutils_2.4         corpcor_1.6.10        #> [85] bslib_0.9.0           class_7.3-23          Rcpp_1.1.1            #> [88] fastmatch_1.1-6       gridExtra_2.3         coda_0.19-4.1         #> [91] nlme_3.1-168          xfun_0.55             fs_1.6.6              #> [94] pkgconfig_2.0.3"},{"path":"http://mkdiro-o.github.io/phylobar/articles/runtime_evaluation.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Comparing Runtime across Sample Sizes and Number of Taxa","text":"vignette studies phylobar’s runtime scales number samples (N) taxa (P). simulate random data across grid (N, P) values time call system.time(). also compare runtime without ordering samples hierarchical clustering (hclust_order argument).","code":"library(ape) library(ggplot2) library(phylobar) theme_set(theme_classic()) set.seed(20260209)"},{"path":"http://mkdiro-o.github.io/phylobar/articles/runtime_evaluation.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Comparing Runtime across Sample Sizes and Number of Taxa","text":"simulate one large dataset maximum grid dimensions subset (N, P) combination. avoids repeated simulation naming boilerplate inside timing loops.","code":"n_eval <- c(50, 100, 250, 500, 1000, 2000) p_eval <- c(50, 100, 250, 500, 1000) n_reps <- 10  grid <- expand.grid(     N = n_eval,     P = p_eval,     hclust_order = c(TRUE, FALSE),     rep = seq_len(n_reps) ) tree_full <- rtree(max(p_eval)) x_full <- matrix(     rpois(max(n_eval) * max(p_eval), lambda = 5),     nrow = max(n_eval), ncol = max(p_eval) ) colnames(x_full) <- tree_full$tip.label rownames(x_full) <- paste0(\"s\", seq_len(max(n_eval)))  trees <- list() for (p in p_eval) {     tips <- tree_full$tip.label[seq_len(p)]     trees[[as.character(p)]] <- drop.tip(         tree_full, setdiff(tree_full$tip.label, tips)     ) }"},{"path":"http://mkdiro-o.github.io/phylobar/articles/runtime_evaluation.html","id":"timing","dir":"Articles","previous_headings":"","what":"Timing","title":"Comparing Runtime across Sample Sizes and Number of Taxa","text":"(N, P, hclust_order) combination subset pre-simulated data time phylobar(). default phylobar sorts samples using hierarchical clustering, can costly number samples large. also often unnecessary already natural sample ordering (e.g., time). Setting hclust_order = FALSE keeps samples input order.","code":"results <- grid results$elapsed <- NA  for (i in seq_len(nrow(results))) {     tree <- trees[[as.character(results$P[i])]]     x <- x_full[seq_len(results$N[i]), tree$tip.label]      tm <- system.time(         phylobar(x, tree, hclust_order = results$hclust_order[i])     )     results$elapsed[i] <- tm[\"elapsed\"] }"},{"path":"http://mkdiro-o.github.io/phylobar/articles/runtime_evaluation.html","id":"results","dir":"Articles","previous_headings":"","what":"Results","title":"Comparing Runtime across Sample Sizes and Number of Taxa","text":"","code":"results$P <- factor(results$P) results$hclust_label <- ifelse(     results$hclust_order,     \"hclust_order = TRUE\",     \"hclust_order = FALSE\" )  ggplot(results, aes(N, elapsed, color = P)) +     geom_point() +     scale_color_brewer(palette = \"Set2\") +     facet_wrap(~ hclust_label) +     theme(panel.border = element_rect(fill = NA, linewidth = 0.9)) +     labs(         x = \"Number of Samples (N)\",         y = \"Elapsed Time (seconds)\",         color = \"Taxa (P)\"     )"},{"path":"http://mkdiro-o.github.io/phylobar/articles/runtime_evaluation.html","id":"visualization","dir":"Articles","previous_headings":"","what":"Visualization","title":"Comparing Runtime across Sample Sizes and Number of Taxa","text":"example phylobar visualization made N=2000N = 2000 samples P=1000P = 1000 taxa. phylobar generates plot SVG elements seconds, output difficult browser render interactively us visually interperet. ’ve disabled plot documentation consumes quite lot browser memory drawing bars barplot. regime, recommend using subset_cluster function select representative samples include stacked bar plot. Alternatively, separate phylobar views can made different sample subsets. long reduce NN, can keep P=1000P = 1000 still smooth interaction.","code":"# very slow rendering, not recommended phylobar(x, tree, hclust_order = results$hclust_order[i]) x_sub <- subset_cluster(x, k = 100) x_sub <- x_sub[, colSums(x_sub) > 0] phylobar(x_sub, tree, hclust_order = results$hclust_order[i])"},{"path":"http://mkdiro-o.github.io/phylobar/articles/runtime_evaluation.html","id":"takeaways","dir":"Articles","previous_headings":"","what":"Takeaways","title":"Comparing Runtime across Sample Sizes and Number of Taxa","text":"Bypassing hierarchical clustering step helps large NN PP setting. data large, may worth using custom, scalable seriation algorithm sort rows x advance, set hclust_order = FALSE. phylobar function executes quickly, rendering visual interpretation suffer NN large. NN PP large, initial view show N×PN \\times P rectangles stacked barplot. Rendering rectangles SVG elements browser can slow, stacked bar plots many bars illegible. recommend either finding representative samples breaking exploration separate subsets samples.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/articles/runtime_evaluation.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Comparing Runtime across Sample Sizes and Number of Taxa","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.7.3 #>  #> Matrix products: default #> BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] phylobar_0.99.0  ggplot2_4.0.1    ape_5.8-1        BiocStyle_2.37.1 #>  #> loaded via a namespace (and not attached): #>  [1] sass_0.4.10         generics_0.1.4      lattice_0.22-7      #>  [4] digest_0.6.39       magrittr_2.0.4      evaluate_1.0.5      #>  [7] grid_4.5.2          RColorBrewer_1.1-3  bookdown_0.45       #> [10] fastmap_1.2.0       jsonlite_2.0.0      Matrix_1.7-4        #> [13] BiocManager_1.30.26 purrr_1.2.1         scales_1.4.0        #> [16] codetools_0.2-20    textshaping_1.0.4   jquerylib_0.1.4     #> [19] cli_3.6.5           rlang_1.1.7         withr_3.0.2         #> [22] cachem_1.1.0        yaml_2.3.12         otel_0.2.0          #> [25] tools_4.5.2         parallel_4.5.2      dplyr_1.1.4         #> [28] fastmatch_1.1-6     vctrs_0.7.0         R6_2.6.1            #> [31] lifecycle_1.0.5     fs_1.6.6            htmlwidgets_1.6.4   #> [34] ragg_1.5.0          cluster_2.1.8.1     pkgconfig_2.0.3     #> [37] desc_1.4.3          pkgdown_2.1.3       bslib_0.9.0         #> [40] pillar_1.11.1       gtable_0.3.6        glue_1.8.0          #> [43] phangorn_2.12.1     Rcpp_1.1.1          systemfonts_1.3.1   #> [46] xfun_0.55           tibble_3.3.1        tidyselect_1.2.1    #> [49] knitr_1.51          dichromat_2.0-0.1   farver_2.1.2        #> [52] igraph_2.2.1        htmltools_0.5.9     nlme_3.1-168        #> [55] labeling_0.4.3      rmarkdown_2.30      compiler_4.5.2      #> [58] quadprog_1.5-8      S7_0.2.1"},{"path":"http://mkdiro-o.github.io/phylobar/articles/taxonomies.html","id":"checking-that-that-the-induced-tree-is-correct","dir":"Articles","previous_headings":"","what":"Checking that that the induced tree is correct","title":"Building Trees from Taxonomies","text":"looking potential issues, let’s review check whether input tree valid. block , generate random tree using rtree function ape. can confirm validity checkValidPhylo function. output TRUE, tree can used phylobar visualizations. , function provides hints adjust taxonomy table taxonomy_to_tree produces valid tree.","code":"tree <- rtree(20) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 20  #> Found number of nodes: m = 19  #> Done."},{"path":"http://mkdiro-o.github.io/phylobar/articles/taxonomies.html","id":"introducing-a-missing-root-node","dir":"Articles","previous_headings":"","what":"Introducing a missing root node","title":"Building Trees from Taxonomies","text":"One common issue absence root node links descendant microbes. Many taxonomy tables implicitly assume Bacteria kingdom begin phylum level. cases, validity checks may fail error like one . occurs phylum treated separate tree, rather connected single tree Kingdom root. problem can resolved introducing new “kingdom” column phyla descend. fix, taxonomy_to_tree correctly builds edges first second columns. Re-running validity check now produces valid tree object, used earlier Atlas vignette.","code":"data(atlas1006, package = \"microbiome\") tree <- taxonomy_to_tree(tax_table(atlas1006)) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 128  #> Found number of nodes: m = 23  #>   FATAL: nodes and tips should appear only once in the 2nd column of 'edge' #>   FATAL: the root node should not appear in the 2nd column of 'edge' #> Done. taxa <- tax_table(atlas1006) taxa <- cbind(Kingdom = \"Bacteria\", taxa) taxa <- phylobar::add_prefix(taxa)  tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 130  #> Found number of nodes: m = 31  #> Done."},{"path":"http://mkdiro-o.github.io/phylobar/articles/taxonomies.html","id":"skipping-over-missing-taxonomic-assignments","dir":"Articles","previous_headings":"","what":"Skipping over missing taxonomic assignments","title":"Building Trees from Taxonomies","text":"Another common issue involves missing taxonomic assignments. phylobar can skip missing entries, encoded NA. missing values stored character strings (e.g., “unclassified”), treated valid categories. Since often appear multiple levels resolution different parents, breaks tree structure. avoid , missing values explicitly coded NA. approach illustrated high-fat, high-sugar diet vignette, taxonomy table pre-processed replace placeholder strings NA. taxonomy correction. Notice NAs properly coded – see prefix coming taxonomic level, corresponding name. address block , checking whether name ended __ replacing explicit NA value. transformation made, table can used construct valid tree.","code":"data(HFHSdata, package = \"LUPINE\") taxa <- HFHSdata$filtered_taxonomy tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 8  #> Found number of nodes: m = 287  #>   FATAL: each tip must appear once in 'edge' #>   FATAL: all nodes should appear at least twice in 'edge' #>   MODERATE: some nodes are of degree 1 or less #>   FATAL: nodes and tips should appear only once in the 2nd column of 'edge' #> Done. head(taxa) #>            X1          X2                X3              X4                X5 #> OTU_13 OTU_13 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #> OTU_21 OTU_21 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #> OTU_7   OTU_7 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #> OTU_29 OTU_29 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #> OTU_30 OTU_30 k__Bacteria     p__Firmicutes   c__Clostridia  o__Clostridiales #> OTU_14 OTU_14 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #>                       X6   X7   X8 #> OTU_13          f__S24-7  g__  s__ #> OTU_21          f__S24-7  g__  s__ #> OTU_7           f__S24-7  g__  s__ #> OTU_29  f__Rikenellaceae  g__  s__ #> OTU_30               f__  g__  s__ #> OTU_14          f__S24-7  g__  s__ taxa <- taxa |>     select(-X1, X1) |>     mutate(across(everything(), ~if_else(str_ends(., \"_\"), NA, .)))  head(taxa) #>                 X2                X3              X4                X5 #> OTU_13 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #> OTU_21 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #> OTU_7  k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #> OTU_29 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #> OTU_30 k__Bacteria     p__Firmicutes   c__Clostridia  o__Clostridiales #> OTU_14 k__Bacteria  p__Bacteroidetes  c__Bacteroidia  o__Bacteroidales #>                       X6   X7   X8     X1 #> OTU_13          f__S24-7 <NA> <NA> OTU_13 #> OTU_21          f__S24-7 <NA> <NA> OTU_21 #> OTU_7           f__S24-7 <NA> <NA>  OTU_7 #> OTU_29  f__Rikenellaceae <NA> <NA> OTU_29 #> OTU_30              <NA> <NA> <NA> OTU_30 #> OTU_14          f__S24-7 <NA> <NA> OTU_14 tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 212  #> Found number of nodes: m = 80  #> Done."},{"path":"http://mkdiro-o.github.io/phylobar/articles/taxonomies.html","id":"avoiding-duplicated-names-across-different-taxonomic-levels","dir":"Articles","previous_headings":"","what":"Avoiding duplicated names across different taxonomic levels","title":"Building Trees from Taxonomies","text":"Another common problem arises taxonomic names explicitly distinguished across different levels resolution. example, dietswap dataset, phylum- family-level assignments share names. uncorrected, taxonomy_to_tree interprets edges loops, produces invalid tree. validity check fail case. see , let’s first extract taxonomy table. Note repeated phylum family names. causes check fail. address , can add small prefix encodes taxonomic rank assignment. helper function add_prefix supports concatenation. stage, however, running validity check still raises error. Atlas example, issue absence root node connecting different phyla. Adding “Kingdom” column resolves linking trees together. issue duplicated taxonomy names also appears Global Patterns dataset. instance, several phylum- class-level assignments share identical names. duplication results invalid phylo. , can resolve using add_prefix function. dataset raises one additional challenge: ASV names stored row names, explicit column taxonomy table. Without , reach leaf nodes tree. solution introduce new column containing ASV identifiers. adjustment, checking validity resulting tree still returns error. case, error can safely ignored: occurs tree contains nodes two descendants. phylobar accommodates multifurcations without issue. verify, can simply plot phylo object directly creating phylobar visualization. can check static version tree work main Global Patterns vignette.","code":"data(\"dietswap\", package = \"microbiome\") diet_temp <- subset_samples(dietswap, timepoint == 1) diet <- subset_taxa(diet_temp, taxa_sums(diet_temp) > 0) taxa <- tax_table(diet) head(taxa) #> Taxonomy Table:     [6 taxa by 3 taxonomic ranks]: #>                              Phylum            Family                     #> Actinomycetaceae             \"Actinobacteria\"  \"Actinobacteria\"           #> Aeromonas                    \"Proteobacteria\"  \"Proteobacteria\"           #> Akkermansia                  \"Verrucomicrobia\" \"Verrucomicrobia\"          #> Alcaligenes faecalis et rel. \"Proteobacteria\"  \"Proteobacteria\"           #> Allistipes et rel.           \"Bacteroidetes\"   \"Bacteroidetes\"            #> Anaerostipes caccae et rel.  \"Firmicutes\"      \"Clostridium cluster XIVa\" #>                              Genus                          #> Actinomycetaceae             \"Actinomycetaceae\"             #> Aeromonas                    \"Aeromonas\"                    #> Akkermansia                  \"Akkermansia\"                  #> Alcaligenes faecalis et rel. \"Alcaligenes faecalis et rel.\" #> Allistipes et rel.           \"Allistipes et rel.\"           #> Anaerostipes caccae et rel.  \"Anaerostipes caccae et rel.\" tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 117  #> Found number of nodes: m = 22  #>   FATAL: nodes and tips should appear only once in the 2nd column of 'edge' #>   FATAL: the root node should not appear in the 2nd column of 'edge' #> Done. taxa <- phylobar::add_prefix(taxa) taxa <- cbind(Kingdom = \"k_Bacteria\", taxa) tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 119  #> Found number of nodes: m = 30  #> Done. data(GlobalPatterns, package = \"phyloseq\") chlamydiae <- subset_taxa(GlobalPatterns, Phylum == \"Chlamydiae\") taxa <- tax_table(chlamydiae) head(taxa) #> Taxonomy Table:     [6 taxa by 7 taxonomic ranks]: #>        Kingdom    Phylum       Class        Order          Family              #> 100535 \"Bacteria\" \"Chlamydiae\" \"Chlamydiae\" \"Chlamydiales\" \"Waddliaceae\"       #> 2936   \"Bacteria\" \"Chlamydiae\" \"Chlamydiae\" \"Chlamydiales\" \"Waddliaceae\"       #> 24341  \"Bacteria\" \"Chlamydiae\" \"Chlamydiae\" \"Chlamydiales\" \"Parachlamydiaceae\" #> 579085 \"Bacteria\" \"Chlamydiae\" \"Chlamydiae\" \"Chlamydiales\" \"Parachlamydiaceae\" #> 547579 \"Bacteria\" \"Chlamydiae\" \"Chlamydiae\" \"Chlamydiales\" \"Parachlamydiaceae\" #> 136933 \"Bacteria\" \"Chlamydiae\" \"Chlamydiae\" \"Chlamydiales\" \"Parachlamydiaceae\" #>        Genus                      Species                               #> 100535 \"Waddlia\"                  NA                                    #> 2936   \"Waddlia\"                  \"Waddliachondrophila\"                 #> 24341  NA                         NA                                    #> 579085 NA                         NA                                    #> 547579 \"CandidatusProtochlamydia\" NA                                    #> 136933 \"CandidatusProtochlamydia\" \"CandidatusProtochlamydiaamoebophila\" tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 5  #> Found number of nodes: m = 9  #>   FATAL: all nodes should appear at least twice in 'edge' #>   FATAL: nodes and tips should appear only once in the 2nd column of 'edge' #> Done. taxa <- data.frame(taxa) taxa <- phylobar::add_prefix(taxa) taxa$ASV <- rownames(taxa) head(taxa) #>           Kingdom       Phylum        Class          Order              Family #> 100535 K_Bacteria P_Chlamydiae C_Chlamydiae O_Chlamydiales       F_Waddliaceae #> 2936   K_Bacteria P_Chlamydiae C_Chlamydiae O_Chlamydiales       F_Waddliaceae #> 24341  K_Bacteria P_Chlamydiae C_Chlamydiae O_Chlamydiales F_Parachlamydiaceae #> 579085 K_Bacteria P_Chlamydiae C_Chlamydiae O_Chlamydiales F_Parachlamydiaceae #> 547579 K_Bacteria P_Chlamydiae C_Chlamydiae O_Chlamydiales F_Parachlamydiaceae #> 136933 K_Bacteria P_Chlamydiae C_Chlamydiae O_Chlamydiales F_Parachlamydiaceae #>                             Genus                             Species    ASV #> 100535                  G_Waddlia                                <NA> 100535 #> 2936                    G_Waddlia                 Waddliachondrophila   2936 #> 24341                        <NA>                                <NA>  24341 #> 579085                       <NA>                                <NA> 579085 #> 547579 G_CandidatusProtochlamydia                                <NA> 547579 #> 136933 G_CandidatusProtochlamydia CandidatusProtochlamydiaamoebophila 136933 tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 21  #> Found number of nodes: m = 15  #>   FATAL: all nodes should appear at least twice in 'edge' #> Done. plot(tree) sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.7.3 #>  #> Matrix products: default #> BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] stringr_1.6.0    phyloseq_1.53.0  phylobar_0.99.0  dplyr_1.1.4      #> [5] ape_5.8-1        BiocStyle_2.37.1 #>  #> loaded via a namespace (and not attached): #>  [1] ade4_1.7-23         tidyselect_1.2.1    farver_2.1.2        #>  [4] Biostrings_2.77.2   S7_0.2.1            fastmap_1.2.0       #>  [7] digest_0.6.39       lifecycle_1.0.5     cluster_2.1.8.1     #> [10] survival_3.8-3      magrittr_2.0.4      compiler_4.5.2      #> [13] rlang_1.1.7         sass_0.4.10         tools_4.5.2         #> [16] igraph_2.2.1        yaml_2.3.12         data.table_1.18.0   #> [19] knitr_1.51          phangorn_2.12.1     htmlwidgets_1.6.4   #> [22] plyr_1.8.9          RColorBrewer_1.1-3  withr_3.0.2         #> [25] purrr_1.2.1         BiocGenerics_0.55.1 desc_1.4.3          #> [28] grid_4.5.2          stats4_4.5.2        multtest_2.65.0     #> [31] biomformat_1.37.0   Rhdf5lib_1.31.0     ggplot2_4.0.1       #> [34] scales_1.4.0        iterators_1.0.14    MASS_7.3-65         #> [37] dichromat_2.0-0.1   cli_3.6.5           rmarkdown_2.30      #> [40] vegan_2.7-2         crayon_1.5.3        ragg_1.5.0          #> [43] generics_0.1.4      otel_0.2.0          reshape2_1.4.5      #> [46] cachem_1.1.0        rhdf5_2.53.5        splines_4.5.2       #> [49] parallel_4.5.2      BiocManager_1.30.26 XVector_0.49.1      #> [52] vctrs_0.7.0         Matrix_1.7-4        jsonlite_2.0.0      #> [55] bookdown_0.45       IRanges_2.43.5      S4Vectors_0.47.4    #> [58] systemfonts_1.3.1   foreach_1.5.2       jquerylib_0.1.4     #> [61] glue_1.8.0          pkgdown_2.1.3       codetools_0.2-20    #> [64] stringi_1.8.7       gtable_0.3.6        quadprog_1.5-8      #> [67] tibble_3.3.1        pillar_1.11.1       htmltools_0.5.9     #> [70] Seqinfo_0.99.2      rhdf5filters_1.21.0 R6_2.6.1            #> [73] textshaping_1.0.4   evaluate_1.0.5      lattice_0.22-7      #> [76] Biobase_2.69.1      bslib_0.9.0         Rcpp_1.1.1          #> [79] fastmatch_1.1-6     nlme_3.1-168        permute_0.9-8       #> [82] mgcv_1.9-3          xfun_0.55           fs_1.6.6            #> [85] pkgconfig_2.0.3"},{"path":"http://mkdiro-o.github.io/phylobar/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kris Sankaran. Author, maintainer, funder. Megan Kuo. Author. Saritha Kodikara. Author. Jiadong Mao. Author.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kuo M, Lê Cao K, Kodikara S, Mao J, Sankaran K (2025). “phylobar: R package multiresolution compositional barplots omics studies.” bioRxiv. doi:10.1101/2025.11.05.686662, https://doi.org/10.1101/2025.11.05.686662.","code":"@Article{,   title = {phylobar: an R package for multiresolution compositional barplots in omics studies},   author = {Megan Kuo and Kim-Anh {Lê Cao} and Saritha Kodikara and Jiadong Mao and Kris Sankaran},   year = {2025},   journal = {bioRxiv},   doi = {10.1101/2025.11.05.686662},   url = {https://doi.org/10.1101/2025.11.05.686662}, }"},{"path":"http://mkdiro-o.github.io/phylobar/index.html","id":"phylobar","dir":"","previous_headings":"","what":"Interactive construction of stacked barplots using hierarchies","title":"Interactive construction of stacked barplots using hierarchies","text":"phylobar visualization package constructing stacked barplots interactively “painting” associated tree. alternative defining color palette fixed taxonomic resolution. also helps avoid issue grouping rare taxa color “” — can selectively highlight specific rare taxa leaving others background color. main function, phylobar, takes two inputs: table potentially normalized counts tree structure can come either phylogeny table taxonomic assignments. vignettes show convert alternative data formats (e.g., phyloseq) input format. can export interactive snapshots SVG using SVG crowbar package, shown “Exporting Views” vignette. can read package preprint: Kuo, M., Lê Cao, K.-., Kodikara, S., Mao, J., & Sankaran, K. (2025). phylobar: R package multiresolution compositional barplots omics studies. doi:10.1101/2025.11.05.686662","code":""},{"path":"http://mkdiro-o.github.io/phylobar/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Interactive construction of stacked barplots using hierarchies","text":"can install development version phylobar using:","code":"remotes::install_github(\"mkdiro-o/phylobar\")"},{"path":"http://mkdiro-o.github.io/phylobar/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Interactive construction of stacked barplots using hierarchies","text":"block applies phylobar small random data set: can click node collapse subtree, press control key add new color, press escape key freeze view. want try examples right away, precompiled articles. ’s recording interactions HFHS data.","code":"library(ape) library(phylobar)  tree <- rtree(20) samples <- matrix(rpois(100 * 20, 1), 100, 20) phylobar(samples, tree)"},{"path":"http://mkdiro-o.github.io/phylobar/index.html","id":"common-tasks","dir":"","previous_headings":"","what":"Common Tasks","title":"Interactive construction of stacked barplots using hierarchies","text":"Customizing style: Phylobar supports styling customizations, like changing size text labels color palette. vignette walks currently available options. Building tree taxonomy: Rather interacting abstract phylogenetic trees can helpful choose stacked bar color using taxonomic assignments. vignette gets quick overview constructing trees taxonomy tables, including checks make sure input formatted properly. Exporting views: interactivity useful exploration, often need export specific static view discuss others. vignette gives alternative simple screenshots preserves image quality supports, editing software like illustrator inkscape. Subsetting representative samples: Stacked bar plots can cumbersome many samples (e.g., > 1000) present, bars become thin. vignette includes helper functions create views representative samples.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"Interactive construction of stacked barplots using hierarchies","text":"full function reference can found : https://mkdiro-o.github.io/phylobar/reference/index.html.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/index.html","id":"learn-more","dir":"","previous_headings":"","what":"Learn More","title":"Interactive construction of stacked barplots using hierarchies","text":"Additional vignettes provide fully developed examples quality control, cross group comparison, longitudinal analysis. package design follows focus-plus-context principle data visualization – paper provides -depth discussion. package implemented using htmlwidgets package R-JavaScript integration. JavaScript code available npm phylobar-js.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"Interactive construction of stacked barplots using hierarchies","text":"can reach us creating Issue emailing ksankaran@wisc.edu. appreciate interest respond promptly.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":null,"dir":"Reference","previous_headings":"","what":"Add rank prefixes to taxonomic matrix values. — add_prefix","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"value taxonomic matrix (except last column), adds prefix based first character column (rank) name. example, column \"Genus\", prefix \"G_\".","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"","code":"add_prefix(taxa)"},{"path":"http://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"taxa character matrix columns representing taxonomic ranks rows representing taxa.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"character matrix prefixes added value (except last column).","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"","code":"taxa <- matrix(   c(\"Firmicutes\", \"Bacilli\", \"Lactobacillales\",     \"Proteobacteria\", \"Gammaproteobacteria\", \"Enterobacterales\"),   ncol = 3, byrow = TRUE,   dimnames = list(NULL, c(\"Phylum\", \"Class\", \"Order\")) ) add_prefix(taxa) #>      Phylum             Class                   Order              #> [1,] \"P_Firmicutes\"     \"C_Bacilli\"             \"Lactobacillales\"  #> [2,] \"P_Proteobacteria\" \"C_Gammaproteobacteria\" \"Enterobacterales\""},{"path":"http://mkdiro-o.github.io/phylobar/reference/bray_curtis_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Bray-Curtis dissimilarity matrix — bray_curtis_dist","title":"Bray-Curtis dissimilarity matrix — bray_curtis_dist","text":"Pairwise Bray-Curtis dissimilarity matrix rows. \\(\\sum |x_i - y_i| / (\\sum x_i + \\sum y_i)\\).","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/bray_curtis_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bray-Curtis dissimilarity matrix — bray_curtis_dist","text":"","code":"bray_curtis_dist(x)"},{"path":"http://mkdiro-o.github.io/phylobar/reference/bray_curtis_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bray-Curtis dissimilarity matrix — bray_curtis_dist","text":"x matrix samples rows.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/bray_curtis_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bray-Curtis dissimilarity matrix — bray_curtis_dist","text":"dist object pairwise Bray-Curtis dissimilarities.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"Takes two column matrix (parents -> descendants) constructs ape phylo object .","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"","code":"edgelist_to_phylo(edgelist)"},{"path":"http://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"edgelist two-column matrix row represents parent-descendant relationship.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"object class 'phylo' representing tree structure.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"","code":"# Example edge list: parent -> child edgelist <- matrix(   c(\"A\", \"B\",     \"A\", \"C\",     \"B\", \"D\",     \"B\", \"E\"),   ncol = 2, byrow = TRUE,   dimnames = list(NULL, c(\"parent\", \"child\")) ) tree <- edgelist_to_phylo(edgelist) str(tree) #> List of 4 #>  $ edge      : int [1:4, 1:2] 4 4 5 5 5 1 2 3 #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:4] \"A\" \"A\" \"B\" \"B\" #>   .. ..$ : NULL #>  $ tip.label : chr [1:3] \"C\" \"D\" \"E\" #>  $ node.label: chr [1:2] \"A\" \"B\" #>  $ Nnode     : int 2 #>  - attr(*, \"class\")= chr \"phylo\""},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct Initial Hierarchy — node_hierarchy","title":"Construct Initial Hierarchy — node_hierarchy","text":"reshapes list output node_totals hierarchical format needed d3 tree visualization.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct Initial Hierarchy — node_hierarchy","text":"","code":"node_hierarchy(tree, totals, node = NULL)"},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct Initial Hierarchy — node_hierarchy","text":"tree object class phylo, representing tree structure. totals named list node totals, returned node_totals. node Name node start recursion. Defaults root node.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct Initial Hierarchy — node_hierarchy","text":"nested list representing hierarchy, node containing ' name, value, summary, children ().","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct Initial Hierarchy — node_hierarchy","text":"","code":"library(ape) tree <- rtree(5) x_mat <- matrix(runif(15), ncol = 5) colnames(x_mat) <- tree$tip.label  tree$node.label <- as.character(seq_len(tree$Nnode)) totals <- c(   node_totals(tree, x_mat),   as.list(data.frame(x_mat)) ) node_hierarchy(tree, totals) #> $name #> [1] \"1\" #>  #> $value #>          [,1] #> [1,] 2.877252 #> [2,] 1.668961 #> [3,] 2.884882 #>  #> $summary #> [1] 7.431095 #>  #> $children #> $children[[1]] #> $children[[1]]$name #> [1] \"2\" #>  #> $children[[1]]$value #>          [,1] #> [1,] 2.172665 #> [2,] 0.935959 #> [3,] 1.541982 #>  #> $children[[1]]$summary #> [1] 4.650606 #>  #> $children[[1]]$children #> $children[[1]]$children[[1]] #> $children[[1]]$children[[1]]$name #> [1] \"t4\" #>  #> $children[[1]]$children[[1]]$value #>           [,1] #> [1,] 0.7353196 #> [2,] 0.1959567 #> [3,] 0.9805397 #>  #> $children[[1]]$children[[1]]$summary #> [1] 1.911816 #>  #> $children[[1]]$children[[1]]$children #> [1] NA #>  #>  #> $children[[1]]$children[[2]] #> $children[[1]]$children[[2]]$name #> [1] \"3\" #>  #> $children[[1]]$children[[2]]$value #>           [,1] #> [1,] 1.4373454 #> [2,] 0.7400023 #> [3,] 0.5614428 #>  #> $children[[1]]$children[[2]]$summary #> [1] 2.73879 #>  #> $children[[1]]$children[[2]]$children #> $children[[1]]$children[[2]]$children[[1]] #> $children[[1]]$children[[2]]$children[[1]]$name #> [1] \"t2\" #>  #> $children[[1]]$children[[2]]$children[[1]]$value #>            [,1] #> [1,] 0.74152153 #> [2,] 0.05144628 #> [3,] 0.53021246 #>  #> $children[[1]]$children[[2]]$children[[1]]$summary #> [1] 1.32318 #>  #> $children[[1]]$children[[2]]$children[[1]]$children #> [1] NA #>  #>  #> $children[[1]]$children[[2]]$children[[2]] #> $children[[1]]$children[[2]]$children[[2]]$name #> [1] \"t1\" #>  #> $children[[1]]$children[[2]]$children[[2]]$value #>            [,1] #> [1,] 0.69582388 #> [2,] 0.68855600 #> [3,] 0.03123033 #>  #> $children[[1]]$children[[2]]$children[[2]]$summary #> [1] 1.41561 #>  #> $children[[1]]$children[[2]]$children[[2]]$children #> [1] NA #>  #>  #>  #>  #>  #>  #> $children[[2]] #> $children[[2]]$name #> [1] \"4\" #>  #> $children[[2]]$value #>           [,1] #> [1,] 0.7045871 #> [2,] 0.7330021 #> [3,] 1.3428995 #>  #> $children[[2]]$summary #> [1] 2.780489 #>  #> $children[[2]]$children #> $children[[2]]$children[[1]] #> $children[[2]]$children[[1]]$name #> [1] \"t3\" #>  #> $children[[2]]$children[[1]]$value #>           [,1] #> [1,] 0.2255625 #> [2,] 0.3008308 #> [3,] 0.6364656 #>  #> $children[[2]]$children[[1]]$summary #> [1] 1.162859 #>  #> $children[[2]]$children[[1]]$children #> [1] NA #>  #>  #> $children[[2]]$children[[2]] #> $children[[2]]$children[[2]]$name #> [1] \"t5\" #>  #> $children[[2]]$children[[2]]$value #>           [,1] #> [1,] 0.4790245 #> [2,] 0.4321713 #> [3,] 0.7064338 #>  #> $children[[2]]$children[[2]]$summary #> [1] 1.61763 #>  #> $children[[2]]$children[[2]]$children #> [1] NA #>  #>  #>  #>  #>"},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Node Totals — node_totals","title":"Compute Node Totals — node_totals","text":"loops internal nodes tree takes sum descendant taxa, sample.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Node Totals — node_totals","text":"","code":"node_totals(tree, x_mat)"},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Node Totals — node_totals","text":"tree object class phylo, representing tree structure. Must tip labels matching columns x_mat. x_mat numeric matrix abundances, samples rows features (tips) columns. Column names correspond tree tip","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Node Totals — node_totals","text":"named list element corresponds internal node (node label) contains vector totals sample, computed summing abundances descendant tips.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Node Totals — node_totals","text":"","code":"library(ape) tree <- rtree(5) x_mat <- matrix(runif(15), ncol = 5) colnames(x_mat) <- tree$tip.label tree$node.label <- as.character(seq_len(tree$Nnode)) node_totals(tree, x_mat) #> $`1` #> [1] 3.315717 2.257086 1.864552 #>  #> $`2` #> [1] 2.032234 1.118343 1.128430 #>  #> $`3` #> [1] 1.2070343 0.8445247 0.5583851 #>  #> $`4` #> [1] 1.2834830 1.1387432 0.7361214 #>"},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":null,"dir":"Reference","previous_headings":"","what":"Tree + Stacked Bars — phylobar","title":"Tree + Stacked Bars — phylobar","text":"phylobar visualization package makes possible construct stacked barplot interactively \"painting\" associated tree. alternative defining color palette using fixed taxonomic resolution. also helps avoid issue grouping rare taxa color \"\" since species can chosen selectively, can paint rare taxa rest.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tree + Stacked Bars — phylobar","text":"","code":"phylobar(   x,   tree,   hclust_order = TRUE,   palette = NULL,   width = NULL,   height = NULL,   sample_font_size = 8,   sample_label_margin = 10,   sample_label_space = 50,   sample_magnify = 1.5,   sample_show_all = TRUE,   element_id = NULL,   rel_width = 0.4,   rel_height = 0.85,   rel_space = 10,   legend_mode = TRUE,   legend_x_start = 5,   legend_spacing = 16 )"},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tree + Stacked Bars — phylobar","text":"x matrix abundances. Samples along rows, features along columns. tree object class phylo, representing tree structure. hclust_order Logical; TRUE, reorder rows/columns hierarchical clustering. palette Character vector colors stacked bars. NULL, uses default palette: c(\"#9c7bbaff\", \"#6eb8acff\", \"#ce7b7bff\", \"#7b9cc4ff\", \"#c47ba0ff\", \"#e1d07eff\"). width Width widget pixels. NULL, uses window default. height Height widget pixels. NULL, uses window default. sample_font_size Font size sample labels (integer). sample_label_margin Margin sample labels bars pixels. sample_label_space Space allocated sample labels pixels. sample_magnify Magnification factor hovered sample labels. sample_show_all Logical; TRUE, show sample labels. element_id Optional HTML element ID attach widget . rel_width Width tree panel relative overall visualization. Defaults 0.4. rel_height Relative height tree overall visualization. Defaults 0.85. Adjust need /less space legend. rel_space Space tree barplot panels pixels. legend_mode Logical; TRUE (default), display labels painted subtrees legend near bottom tree.  FALSE, include labels within tree . legend_x_start Horizontal starting position (pixels) legend. Defaults 4. legend_spacing Vertical spacing (pixels) legend entries.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tree + Stacked Bars — phylobar","text":"htmlwidget visualization attached element element_id output HTML page.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tree + Stacked Bars — phylobar","text":"","code":"library(ape) tree <- rtree(5) x <- matrix(rpois(15, 1), ncol = 5) phylobar(x, tree)  {\"x\":{\"tree_data\":{\"name\":\"node1\",\"value\":[[6],[3],[10]],\"summary\":19,\"children\":[{\"name\":\"node2\",\"value\":[[4],[1],[9]],\"summary\":14,\"children\":[{\"name\":\"node3\",\"value\":[[2],[1],[8]],\"summary\":11,\"children\":[{\"name\":\"node4\",\"value\":[[1],[1],[7]],\"summary\":9,\"children\":[{\"name\":\"t3\",\"value\":[[1],[0],[5]],\"summary\":6,\"children\":null},{\"name\":\"t2\",\"value\":[[0],[1],[2]],\"summary\":3,\"children\":null}]},{\"name\":\"t5\",\"value\":[[1],[0],[1]],\"summary\":2,\"children\":null}]},{\"name\":\"t4\",\"value\":[[2],[0],[1]],\"summary\":3,\"children\":null}]},{\"name\":\"t1\",\"value\":[[2],[2],[1]],\"summary\":5,\"children\":null}]},\"labels\":[\"sample_3\",\"sample_1\",\"sample_2\"],\"palette\":[\"#9c7bbaff\",\"#6eb8acff\",\"#ce7b7bff\",\"#7b9cc4ff\",\"#c47ba0ff\",\"#e1d07eff\"],\"opts\":{\"legend_mode\":true,\"legend_spacing\":16,\"legend_x_start\":5,\"rel_height\":0.85,\"rel_space\":10,\"rel_width\":0.4,\"sample_font_size\":8,\"sample_label_margin\":10,\"sample_label_space\":50,\"sample_magnify\":1.5,\"sample_show_all\":true}},\"evals\":[],\"jsHooks\":[]}"},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare tree data for phylobar visualization — phylobar_data","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"Prepare tree data phylobar visualization","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"","code":"phylobar_data(x, tree, hclust_order = TRUE)"},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"x matrix abundances. Samples along rows, features along columns. tree n object class phylo, representing tree structure. hclust_order Logical; TRUE, reorder rows/columns hierarchical clustering.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"list tree_data labels.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"","code":"library(ape) tree <- rtree(5) tree$node.label <- paste0(\"node\", seq_len(4)) x <- matrix(runif(15), nrow = 3) colnames(x) <- tree$tip.label rownames(x) <- paste0(\"sample\", seq_len(3)) phylobar_data(x, tree) #> $tree_data #> $tree_data$name #> [1] \"node1\" #>  #> $tree_data$value #>          [,1] #> [1,] 3.294990 #> [2,] 1.836605 #> [3,] 2.950020 #>  #> $tree_data$summary #> [1] 8.081616 #>  #> $tree_data$children #> $tree_data$children[[1]] #> $tree_data$children[[1]]$name #> [1] \"node2\" #>  #> $tree_data$children[[1]]$value #>          [,1] #> [1,] 2.368444 #> [2,] 1.284228 #> [3,] 2.372954 #>  #> $tree_data$children[[1]]$summary #> [1] 6.025626 #>  #> $tree_data$children[[1]]$children #> $tree_data$children[[1]]$children[[1]] #> $tree_data$children[[1]]$children[[1]]$name #> [1] \"node3\" #>  #> $tree_data$children[[1]]$children[[1]]$value #>           [,1] #> [1,] 1.4342445 #> [2,] 0.5015357 #> [3,] 1.3216844 #>  #> $tree_data$children[[1]]$children[[1]]$summary #> [1] 3.257465 #>  #> $tree_data$children[[1]]$children[[1]]$children #> $tree_data$children[[1]]$children[[1]]$children[[1]] #> $tree_data$children[[1]]$children[[1]]$children[[1]]$name #> [1] \"t5\" #>  #> $tree_data$children[[1]]$children[[1]]$children[[1]]$value #>           [,1] #> [1,] 0.5668943 #> [2,] 0.2529970 #> [3,] 0.9188032 #>  #> $tree_data$children[[1]]$children[[1]]$children[[1]]$summary #> [1] 1.738695 #>  #> $tree_data$children[[1]]$children[[1]]$children[[1]]$children #> [1] NA #>  #>  #> $tree_data$children[[1]]$children[[1]]$children[[2]] #> $tree_data$children[[1]]$children[[1]]$children[[2]]$name #> [1] \"t3\" #>  #> $tree_data$children[[1]]$children[[1]]$children[[2]]$value #>           [,1] #> [1,] 0.8673502 #> [2,] 0.2485387 #> [3,] 0.4028812 #>  #> $tree_data$children[[1]]$children[[1]]$children[[2]]$summary #> [1] 1.51877 #>  #> $tree_data$children[[1]]$children[[1]]$children[[2]]$children #> [1] NA #>  #>  #>  #>  #> $tree_data$children[[1]]$children[[2]] #> $tree_data$children[[1]]$children[[2]]$name #> [1] \"node4\" #>  #> $tree_data$children[[1]]$children[[2]]$value #>           [,1] #> [1,] 0.9341994 #> [2,] 0.7826920 #> [3,] 1.0512700 #>  #> $tree_data$children[[1]]$children[[2]]$summary #> [1] 2.768161 #>  #> $tree_data$children[[1]]$children[[2]]$children #> $tree_data$children[[1]]$children[[2]]$children[[1]] #> $tree_data$children[[1]]$children[[2]]$children[[1]]$name #> [1] \"t4\" #>  #> $tree_data$children[[1]]$children[[2]]$children[[1]]$value #>           [,1] #> [1,] 0.7696302 #> [2,] 0.1194854 #> [3,] 0.1946950 #>  #> $tree_data$children[[1]]$children[[2]]$children[[1]]$summary #> [1] 1.083811 #>  #> $tree_data$children[[1]]$children[[2]]$children[[1]]$children #> [1] NA #>  #>  #> $tree_data$children[[1]]$children[[2]]$children[[2]] #> $tree_data$children[[1]]$children[[2]]$children[[2]]$name #> [1] \"t2\" #>  #> $tree_data$children[[1]]$children[[2]]$children[[2]]$value #>           [,1] #> [1,] 0.1645692 #> [2,] 0.6632066 #> [3,] 0.8565750 #>  #> $tree_data$children[[1]]$children[[2]]$children[[2]]$summary #> [1] 1.684351 #>  #> $tree_data$children[[1]]$children[[2]]$children[[2]]$children #> [1] NA #>  #>  #>  #>  #>  #>  #> $tree_data$children[[2]] #> $tree_data$children[[2]]$name #> [1] \"t1\" #>  #> $tree_data$children[[2]]$value #>           [,1] #> [1,] 0.9265464 #> [2,] 0.5523776 #> [3,] 0.5770657 #>  #> $tree_data$children[[2]]$summary #> [1] 2.05599 #>  #> $tree_data$children[[2]]$children #> [1] NA #>  #>  #>  #>  #> $labels #> [1] \"sample1\" \"sample2\" \"sample3\" #>"},{"path":"http://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Subsample rows of a matrix using clustering — subset_cluster","title":"Subsample rows of a matrix using clustering — subset_cluster","text":"function takes matrix x subsamples rows clustering . One representative row selected cluster, helps visualizing large dataset semi-representative way.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subsample rows of a matrix using clustering — subset_cluster","text":"","code":"subset_cluster(x, k = 100, method = c(\"hclust\", \"medoid\"))"},{"path":"http://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subsample rows of a matrix using clustering — subset_cluster","text":"x matrix whose rows clustered subsampled. k number clusters form (default 100). method Clustering method use. \"hclust\" (default) uses Euclidean distances hierarchical clustering, selecting arbitrary member cluster. \"medoid\" uses Bray-Curtis dissimilarity K-medoids (PAM) clustering, selecting medoid cluster.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subsample rows of a matrix using clustering — subset_cluster","text":"matrix containing one representative row cluster.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subsample rows of a matrix using clustering — subset_cluster","text":"","code":"mat <- matrix(rnorm(1000), nrow = 100) rownames(mat) <- seq_len(100) result <- subset_cluster(mat, k = 10) dim(result) # only 10 representatives #> [1] 10 10  # Using Bray-Curtis + K-medoids (better for compositional data) counts <- matrix(rpois(1000, 5), nrow = 100) rownames(counts) <- seq_len(100) result2 <- subset_cluster(counts, k = 10, method = \"medoid\")"},{"path":"http://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"Creates phylo taxonomic tree, skipping NA assignments. Assumes columns sorted coarsest finest taxonomic resolution.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"","code":"taxonomy_to_tree(taxa)"},{"path":"http://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"taxa data.frame matrix columns representing taxonomic ranks (sorted coarsest finest) rows representing taxa. NA empty values skipped.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"object class 'phylo' representing taxonomic tree.","code":""},{"path":"http://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"","code":"taxa <- matrix(   c(\"Firmicutes\", \"Bacilli\", \"Lactobacillales\",     \"Proteobacteria\", \"Gammaproteobacteria\", \"Enterobacterales\"),   ncol = 3, byrow = TRUE,   dimnames = list(NULL, c(\"Phylum\", \"Class\", \"Order\")) ) tree <- taxonomy_to_tree(taxa) str(tree) #> List of 4 #>  $ edge      : int [1:4, 1:2] 3 4 5 6 4 1 6 2 #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:4] \"Firmicutes\" \"Bacilli\" \"Proteobacteria\" \"Gammaproteobacteria\" #>   .. ..$ : NULL #>  $ tip.label : chr [1:2] \"Lactobacillales\" \"Enterobacterales\" #>  $ node.label: chr [1:4] \"Firmicutes\" \"Bacilli\" \"Proteobacteria\" \"Gammaproteobacteria\" #>  $ Nnode     : int 4 #>  - attr(*, \"class\")= chr \"phylo\"  # A more involved example with missing values taxa <- matrix(   c(\"Firmicutes\", \"Bacilli\", \"Lactobacillales\", \"ASV1\",     \"Proteobacteria\", \"Gammaproteobacteria\", \"Enterobacterales\", \"ASV2\",     \"Firmicutes\", \"Bacilli\", NA, \"ASV3\"),   ncol = 4, byrow = TRUE,   dimnames = list(NULL, c(\"Phylum\", \"Class\", \"Order\", \"ASV\")) ) taxmat <- add_prefix(taxa) tree <- taxonomy_to_tree(taxmat) str(tree) #> List of 4 #>  $ edge      : int [1:7, 1:2] 4 5 6 7 8 9 5 5 6 1 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:7] \"P_Firmicutes\" \"C_Bacilli\" \"O_Lactobacillales\" \"P_Proteobacteria\" ... #>   .. ..$ : NULL #>  $ tip.label : chr [1:3] \"ASV1\" \"ASV2\" \"ASV3\" #>  $ node.label: chr [1:6] \"P_Firmicutes\" \"C_Bacilli\" \"O_Lactobacillales\" \"P_Proteobacteria\" ... #>  $ Nnode     : int 6 #>  - attr(*, \"class\")= chr \"phylo\""},{"path":"http://mkdiro-o.github.io/phylobar/news/index.html","id":"phylobar-0990","dir":"Changelog","previous_headings":"","what":"phylobar 0.99.0","title":"phylobar 0.99.0","text":"Initial Bioconductor submission.","code":""}]
