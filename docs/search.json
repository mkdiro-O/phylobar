[{"path":[]},{"path":"https://mkdiro-o.github.io/phylobar/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"CC0 1.0 Universal","title":"CC0 1.0 Universal","text":"CREATIVE COMMONS CORPORATION LAW FIRM PROVIDE LEGAL SERVICES. DISTRIBUTION DOCUMENT CREATE ATTORNEY-CLIENT RELATIONSHIP. CREATIVE COMMONS PROVIDES INFORMATION “-” BASIS. CREATIVE COMMONS MAKES WARRANTIES REGARDING USE DOCUMENT INFORMATION WORKS PROVIDED HEREUNDER, DISCLAIMS LIABILITY DAMAGES RESULTING USE DOCUMENT INFORMATION WORKS PROVIDED HEREUNDER.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/LICENSE.html","id":"statement-of-purpose","dir":"","previous_headings":"","what":"Statement of Purpose","title":"CC0 1.0 Universal","text":"laws jurisdictions throughout world automatically confer exclusive Copyright Related Rights (defined ) upon creator subsequent owner(s) (, “owner”) original work authorship /database (, “Work”). Certain owners wish permanently relinquish rights Work purpose contributing commons creative, cultural scientific works (“Commons”) public can reliably without fear later claims infringement build upon, modify, incorporate works, reuse redistribute freely possible form whatsoever purposes, including without limitation commercial purposes. owners may contribute Commons promote ideal free culture production creative, cultural scientific works, gain reputation greater distribution Work part use efforts others. /purposes motivations, without expectation additional consideration compensation, person associating CC0 Work (“Affirmer”), extent owner Copyright Related Rights Work, voluntarily elects apply CC0 Work publicly distribute Work terms, knowledge Copyright Related Rights Work meaning intended legal effect CC0 rights. Copyright Related Rights. Work made available CC0 may protected copyright related neighboring rights (“Copyright Related Rights”). Copyright Related Rights include, limited , following: right reproduce, adapt, distribute, perform, display, communicate, translate Work; moral rights retained original author(s) /performer(s); publicity privacy rights pertaining person’s image likeness depicted Work; rights protecting unfair competition regards Work, subject limitations paragraph 4(), ; rights protecting extraction, dissemination, use reuse data Work; database rights (arising Directive 96/9/EC European Parliament Council 11 March 1996 legal protection databases, national implementation thereof, including amended successor version directive); similar, equivalent corresponding rights throughout world based applicable law treaty, national implementations thereof. Waiver. greatest extent permitted , contravention , applicable law, Affirmer hereby overtly, fully, permanently, irrevocably unconditionally waives, abandons, surrenders Affirmer’s Copyright Related Rights associated claims causes action, whether now known unknown (including existing well future claims causes action), Work () territories worldwide, (ii) maximum duration provided applicable law treaty (including future time extensions), (iii) current future medium number copies, (iv) purpose whatsoever, including without limitation commercial, advertising promotional purposes (“Waiver”). Affirmer makes Waiver benefit member public large detriment Affirmer’s heirs successors, fully intending Waiver shall subject revocation, rescission, cancellation, termination, legal equitable action disrupt quiet enjoyment Work public contemplated Affirmer’s express Statement Purpose. Public License Fallback. part Waiver reason judged legally invalid ineffective applicable law, Waiver shall preserved maximum extent permitted taking account Affirmer’s express Statement Purpose. addition, extent Waiver judged Affirmer hereby grants affected person royalty-free, non transferable, non sublicensable, non exclusive, irrevocable unconditional license exercise Affirmer’s Copyright Related Rights Work () territories worldwide, (ii) maximum duration provided applicable law treaty (including future time extensions), (iii) current future medium number copies, (iv) purpose whatsoever, including without limitation commercial, advertising promotional purposes (“License”). License shall deemed effective date CC0 applied Affirmer Work. part License reason judged legally invalid ineffective applicable law, partial invalidity ineffectiveness shall invalidate remainder License, case Affirmer hereby affirms () exercise remaining Copyright Related Rights Work (ii) assert associated claims causes action respect Work, either case contrary Affirmer’s express Statement Purpose. Limitations Disclaimers. trademark patent rights held Affirmer waived, abandoned, surrendered, licensed otherwise affected document. Affirmer offers Work -makes representations warranties kind concerning Work, express, implied, statutory otherwise, including without limitation warranties title, merchantability, fitness particular purpose, non infringement, absence latent defects, accuracy, present absence errors, whether discoverable, greatest extent permissible applicable law. Affirmer disclaims responsibility clearing rights persons may apply Work use thereof, including without limitation person’s Copyright Related Rights Work. , Affirmer disclaims responsibility obtaining necessary consents, permissions rights required use Work. Affirmer understands acknowledges Creative Commons party document duty obligation respect CC0 use Work.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/atlas.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"atlas","text":"begin loading mouse diet study data, stored remotely can loaded R phyloseq object. Next, load atlas1006 dataset. simplicity, focus samples r DNA extraction method transform abundances compositional form (sample sums 1). naive attempt build taxonomy-based tree can fail, duplicate names across different levels taxonomy may result loops. address , add level-specific prefixes (e.g., p_ phylum, f_ family), ensuring ancestor descendant nodes unique labels. valid tree abundance matrix, can generate phylobar plot. , samples arranged along x-axis, stacked bars representing taxonomic abundances, aligned corresponding branches tree. full dataset complex, can simplify visualization subsampling representative samples. preserves main conclusions reducing visual clutter.","code":"data(atlas1006) pseq3 <- atlas1006 |>     subset_samples(DNA_extraction_method == \"r\") |>     transform(transform = \"compositional\") tree <- taxonomy_to_tree(tax_table(pseq3)) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 128  #> Found number of nodes: m = 23  #>   FATAL: nodes and tips should appear only once in the 2nd column of 'edge' #>   FATAL: the root node should not appear in the 2nd column of 'edge' #> Done. taxa <- tax_table(pseq3) taxa <- cbind(Kingdom = \"Bacteria\", taxa) taxa <- add_prefix(taxa)  tree <- taxonomy_to_tree(taxa) checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 130  #> Found number of nodes: m = 31  #> Done. x <- t(otu_table(pseq3)) phylobar(x, tree, sample_show_all = FALSE, rel_width = 0.2) x_sub <- subset_cluster(x) x_sub <- x_sub[, colSums(x_sub) > 0]  leaves_to_keep <- intersect(tree$tip.label, colnames(x_sub)) filtered_tree <- drop.tip(tree, setdiff(tree$tip.label, leaves_to_keep)) phylobar(x_sub, filtered_tree)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/atlas.html","id":"interpretation","dir":"Articles","previous_headings":"","what":"Interpretation","title":"atlas","text":"many interesting patterns atlas dataset revealing distinct patterns human intestinal. example, Enterobacter aerogenes appears across broad range samples, generally low relative abundance. one sample shows notable representation, creating narrow band stacked barplot. patchy distribution characteristic opportunistic conditionally rare taxa, may present many individuals rarely dominate community structure. patterns previously described examples bimodal “tipping element” behavior, taxon abundant hosts nearly absent others. (https://pmc.ncbi.nlm.nih.gov/articles/PMC4102116/pdf/ncomms5344.pdf)  Next, screenshot highlights dominance Firmicutes (yellow) Bacteroidetes (purple) human gut microbiome. two phyla prevalent across nearly samples, relative proportions vary widely. samples Firmicutes-dominant, others Bacteroidetes-dominant. variability reflects complex interplay host genetics, diet, environmental factors shape gut microbiome.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/atlas.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"atlas","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] microbiome_1.30.0 ggplot2_4.0.0     phylobar_0.99.0   phangorn_2.12.1   #> [5] htmlwidgets_1.6.4 phyloseq_1.52.0   ape_5.8-1         #>  #> loaded via a namespace (and not attached): #>  [1] ade4_1.7-23             tidyselect_1.2.1        dplyr_1.1.4             #>  [4] farver_2.1.2            Biostrings_2.76.0       S7_0.2.0                #>  [7] fastmap_1.2.0           digest_0.6.37           lifecycle_1.0.4         #> [10] cluster_2.1.8.1         survival_3.8-3          magrittr_2.0.4          #> [13] compiler_4.5.1          rlang_1.1.6             sass_0.4.10             #> [16] tools_4.5.1             igraph_2.1.4            yaml_2.3.10             #> [19] data.table_1.17.8       knitr_1.50              plyr_1.8.9              #> [22] RColorBrewer_1.1-3      Rtsne_0.17              withr_3.0.2             #> [25] purrr_1.1.0             BiocGenerics_0.54.0     desc_1.4.3              #> [28] grid_4.5.1              stats4_4.5.1            multtest_2.64.0         #> [31] biomformat_1.36.0       Rhdf5lib_1.30.0         scales_1.4.0            #> [34] iterators_1.0.14        MASS_7.3-65             cli_3.6.5               #> [37] rmarkdown_2.30          vegan_2.7-1             crayon_1.5.3            #> [40] ragg_1.5.0              generics_0.1.4          httr_1.4.7              #> [43] reshape2_1.4.4          cachem_1.1.0            rhdf5_2.52.1            #> [46] stringr_1.5.2           splines_4.5.1           parallel_4.5.1          #> [49] XVector_0.48.0          vctrs_0.6.5             Matrix_1.7-4            #> [52] jsonlite_2.0.0          IRanges_2.42.0          S4Vectors_0.46.0        #> [55] systemfonts_1.2.3       foreach_1.5.2           tidyr_1.3.1             #> [58] jquerylib_0.1.4         glue_1.8.0              pkgdown_2.1.3           #> [61] codetools_0.2-20        stringi_1.8.7           gtable_0.3.6            #> [64] GenomeInfoDb_1.44.3     UCSC.utils_1.4.0        quadprog_1.5-8          #> [67] tibble_3.3.0            pillar_1.11.1           htmltools_0.5.8.1       #> [70] rhdf5filters_1.20.0     GenomeInfoDbData_1.2.14 R6_2.6.1                #> [73] textshaping_1.0.3       evaluate_1.0.5          lattice_0.22-7          #> [76] Biobase_2.68.0          bslib_0.9.0             Rcpp_1.1.0              #> [79] fastmatch_1.1-6         nlme_3.1-168            permute_0.9-8           #> [82] mgcv_1.9-3              xfun_0.53               fs_1.6.6                #> [85] pkgconfig_2.0.3"},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Oral Microbiome in Cancer Patients","text":"block loads relevant packages. use tidyverse packages preprocessing. Next, load data, organized phyloseq object slots phylogenetic tree, sample metadata, sample-level abundances.","code":"library(ape) library(dplyr) library(phylobar) library(tibble) library(tidyr) ps <- readRDS(\"zhang2023-ps-v2.rds\")"},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"sample-level-analysis","dir":"Articles","previous_headings":"","what":"Sample-Level Analysis","title":"Oral Microbiome in Cancer Patients","text":"now begin sample-level analysis. original dataset includes 1103 samples. simplify visualization, subset 100 representative samples chosen clustering K=100K = 100, implemented subset_cluster. subsetted data, rows correspond representative samples columns correspond OTU abundances. filter OTUs, One issue two OTUs now never appear among visualized samples. Let’s add small pseudocount make sure leaf node least mass.","code":"keep_ix <- rowMeans(otu_table(ps) > 0) > 0.01 ps <- prune_taxa(taxa_names(ps)[keep_ix], ps) x_mat <- t(otu_table(ps)) x_mat <- subset_cluster(x_mat, k = 100) x_mat[1, which(colSums(x_mat) == 0)] <- .00001 x_mat <- x_mat / rowSums(x_mat)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"sample-order","dir":"Articles","previous_headings":"Sample-Level Analysis","what":"Sample order","title":"Oral Microbiome in Cancer Patients","text":"default, phylobar orders samples stacked bar plot according sample similarity. creates clean visualizations, fails address primary interest: variation community composition relates mucositis. Therefore, instead order samples mucositis severity patients gathered. block computes patient-level averages mucositis severity organizes samples first patient severity , within patient, time relative treatment initiation. Although ordering includes every sample dataset, plots use representative subset clustering step. finalize ordering subsetting sample order accordingly.","code":"sample_order <- data.frame(sample_data(ps)) |>     rownames_to_column(\"sample\") |>     group_by(id) |>     mutate(mean_mucositis = mean(mucositis)) |>     ungroup() |>     arrange(mean_mucositis, timediff) |>     pull(sample) row_ix <- sample_order[sample_order %in% rownames(x_mat)] col_ix <- hclust(dist(t(x_mat)))$order"},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"visualization","dir":"Articles","previous_headings":"Sample-Level Analysis","what":"Visualization","title":"Oral Microbiome in Cancer Patients","text":"reorganized matrix used input phylobar. Samples right stacked bar severe mucositis average. use argument sample_show_fall = FALSE use custom ordering defined . sample_label_space = 75 argument gives bit extra vertical space sample labels, bit longer usual.","code":"phylobar(     x_mat[row_ix, col_ix],     phy_tree(ps),     width = 900,     hclust_order = FALSE,     sample_font_size = 6,     sample_label_space = 75 )"},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"interpretation","dir":"Articles","previous_headings":"Sample-Level Analysis","what":"Interpretation","title":"Oral Microbiome in Cancer Patients","text":"highlight interesting findings using screenshots interactive plots. example, tallest bar far left one 16 (1103) samples 10 reads OTU 200, fact dominated OTU 200. suggests possible contamination quality-control issues. questionable OTU seems dominate one samples. Next, highlight two phylogenetic subtrees explore associations mucositis severity. subtree labeled purple (descendants node 0.859.2), higher abundance appears associated lower severity – purples bars larger left hand side stacked barplot. contrast, green subtree (descendants node 0.948.4), higher abundances associated higher severity. high-level phylogenetic groups seem associated mucositis severity. Next, collapse subtrees, resulting smaller tree layout letting us focus remaining phylogenetic groups. highlight bar (red) large values one severe mucositis patients. associated strain, OTU0910, shows high abundance relatively small number patients, patients tend experience worse average mucositis. collapsing parts tree, can study patterns isolated leaves without losing context entire tree.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"temporal-analysis","dir":"Articles","previous_headings":"","what":"Temporal Analysis","title":"Oral Microbiome in Cancer Patients","text":"example visualizes stacked bars sample. However, might interested temporal trends averaged across samples—example, microbiome community structures change course treatment among people vs. less severe mucositis. next part, ’ll create streamgraph alternative stacked bars , stream defined time relative start treatment.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"streamgraph-helpers","dir":"Articles","previous_headings":"Temporal Analysis","what":"Streamgraph helpers","title":"Oral Microbiome in Cancer Patients","text":"helper function computes kernel smoothing abundances species time. consider windows size two days take average across patients within window. final Gaussian kernel averaging applied smooth across adjacent windows. block converts original phyloseq object pair data frames, since format easier manipulate dplyr. also compute average mucositis score individual, identified ID column. derived feature useful understanding disease severity. alternative analysis also consider latent class grouping, discussed Zhang et al. (2023).","code":"smooth_time_series <- function(df, time_col = \"timediff\", pseudocount = 1, round_degree = 2, bandwidth = 5) {     # Round timediffs     df <- df |>         mutate(time_bin = round_degree * round(.data[[time_col]] / round_degree)) |>         arrange(time_bin) |>         group_by(time_bin) |>         summarise(             value = (sum(value) + pseudocount) / (n() + pseudocount)         )      # Fill gaps with 0     tibble(time_bin = seq(min(df$time_bin), max(df$time_bin), by = round_degree)) |>         left_join(df, by = \"time_bin\") |>         mutate(value = replace_na(value, 0)) |>         reframe(             smooth_value = ksmooth(time_bin, value, \"normal\", bandwidth, n.points = n())$y,             time_bin = ksmooth(time_bin, value, \"normal\", bandwidth, n.points = n())$x         ) } x_mat <- t(otu_table(ps)) |>     data.frame() |>     rownames_to_column(\"sample\") metadata <- sample_data(ps) |>     data.frame() |>     rownames_to_column(\"sample\") |>     group_by(id) |>     mutate(mean_mucositis = mean(mucositis))"},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"input-data-preparation","dir":"Articles","previous_headings":"Temporal Analysis","what":"Input data preparation","title":"Oral Microbiome in Cancer Patients","text":"now reshape data long-format can apply smoothing function separately across species (feature data ) disease severity level. Several patients late follow-measurements, focus within 55 days treatment. result, x_smooth, applies kernel smoothing separately mroe vs. less severe mucositis cases, combines results single matrix—first grouped severity, sorted time. allows us study two trends within single stacked bar plot.","code":"x_long_format <- x_mat |>     left_join(metadata, by = \"sample\") |>     filter(between(timediff, -5, 55)) |>     select(id, timediff, mean_mucositis, starts_with(\"OTU\")) |>     pivot_longer(starts_with(\"O\"), names_to = \"feature\", values_to = \"value\")  x_smooth <- x_long_format |>     group_by(feature, severity = if_else(mean_mucositis > 3.5, \"S\", \"NS\")) |>     group_modify(~ smooth_time_series(.x)) |>     unite(row, time_bin, severity, sep = \"\") |>     pivot_wider(names_from = feature, values_from = smooth_value) |>     column_to_rownames(\"row\") x_smooth <- x_smooth / rowSums(x_smooth)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"visualization-1","dir":"Articles","previous_headings":"Temporal Analysis","what":"Visualization","title":"Oral Microbiome in Cancer Patients","text":"can now create phylobar visualization, using phylogenetic tree . x-axis labels indicate severity time window. severe cases shown left side figure.","code":"phylobar(     x_smooth,     phy_tree(ps),     width = 900,     hclust_order = FALSE )"},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"interpretation-1","dir":"Articles","previous_headings":"Temporal Analysis","what":"Interpretation","title":"Oral Microbiome in Cancer Patients","text":"Browsing across different phylogenetic groups, see descendants 0.538 abundant early time points patients severe mucositis. higher lower severity groups, however, abundance subtree decreases time. contrast, OTU0911 remains roughly stable across groups. final time windows lower severity group, appears become slightly abundant, though may artifact averaging smaller number samples available 55 days treatment start. overview phylobar streamgraph, showing high-level taxonomic groups differential trajectories across high low severity groups. Interacting next stacked bars, can identify several individual OTUs interest. example, OTU0307 (highlighted purple) becomes abundant later time points, especially among patients low mucositis. represent candidate species designing therapy aimed managing mucositis. OTU0297 (green) appears briefly midway treatment recovery among low-severity cases, illustrating transient effects can arise microbiome data. Finally, OTU0943 appears slightly abundant among lower severity, though effect tentative. zoomed phylobar streamgraph, focusing OTUs interest. observations emerged minutes interacting phylobar visualization. highlights exploratory potential approach shows dataset can viewed multiple phylogenetic resolutions uncover biologically meaningful trends.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/cancer_oral_microbiome.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Oral Microbiome in Cancer Patients","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] tidyr_1.3.1       tibble_3.3.0      phylobar_0.99.0   phangorn_2.12.1   #> [5] htmlwidgets_1.6.4 phyloseq_1.52.0   dplyr_1.1.4       ape_5.8-1         #> [9] BiocStyle_2.36.0  #>  #> loaded via a namespace (and not attached): #>  [1] ade4_1.7-23             tidyselect_1.2.1        farver_2.1.2            #>  [4] Biostrings_2.76.0       S7_0.2.0                fastmap_1.2.0           #>  [7] digest_0.6.37           lifecycle_1.0.4         cluster_2.1.8.1         #> [10] survival_3.8-3          magrittr_2.0.4          compiler_4.5.1          #> [13] rlang_1.1.6             sass_0.4.10             tools_4.5.1             #> [16] igraph_2.1.4            yaml_2.3.10             data.table_1.17.8       #> [19] knitr_1.50              plyr_1.8.9              RColorBrewer_1.1-3      #> [22] withr_3.0.2             purrr_1.1.0             BiocGenerics_0.54.0     #> [25] desc_1.4.3              grid_4.5.1              stats4_4.5.1            #> [28] multtest_2.64.0         biomformat_1.36.0       Rhdf5lib_1.30.0         #> [31] ggplot2_4.0.0           scales_1.4.0            iterators_1.0.14        #> [34] MASS_7.3-65             cli_3.6.5               rmarkdown_2.30          #> [37] vegan_2.7-1             crayon_1.5.3            ragg_1.5.0              #> [40] generics_0.1.4          httr_1.4.7              reshape2_1.4.4          #> [43] cachem_1.1.0            rhdf5_2.52.1            stringr_1.5.2           #> [46] splines_4.5.1           parallel_4.5.1          BiocManager_1.30.26     #> [49] XVector_0.48.0          vctrs_0.6.5             Matrix_1.7-4            #> [52] jsonlite_2.0.0          bookdown_0.44           IRanges_2.42.0          #> [55] S4Vectors_0.46.0        systemfonts_1.2.3       foreach_1.5.2           #> [58] jquerylib_0.1.4         glue_1.8.0              pkgdown_2.1.3           #> [61] codetools_0.2-20        stringi_1.8.7           gtable_0.3.6            #> [64] GenomeInfoDb_1.44.3     UCSC.utils_1.4.0        quadprog_1.5-8          #> [67] pillar_1.11.1           htmltools_0.5.8.1       rhdf5filters_1.20.0     #> [70] GenomeInfoDbData_1.2.14 R6_2.6.1                textshaping_1.0.3       #> [73] evaluate_1.0.5          lattice_0.22-7          Biobase_2.68.0          #> [76] bslib_0.9.0             Rcpp_1.1.0              fastmatch_1.1-6         #> [79] nlme_3.1-168            permute_0.9-8           mgcv_1.9-3              #> [82] xfun_0.53               fs_1.6.6                pkgconfig_2.0.3"},{"path":"https://mkdiro-o.github.io/phylobar/articles/diet_analysis.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Diet Data","text":"begin loading mouse diet study data, stored remotely can loaded R phyloseq object. prepare data visualization, first convert phyloseq object MicrobiomeStat object using mStat_convert_phyloseq_to_data_obj(). enables us apply DESeq2 normalization, corrects sequencing depth differences across samples. transpose normalized feature matrix rows correspond taxa columns samples, expected phylobar(). Unlike relative-abundance normalization, DESeq2 constrain sample totals equal one. distinction highlights flexibility functions, since phylobar can accommodate compositional non-compositional inputs. normalization, transpose feature matrix rows correspond taxa columns samples, required phylobar(). Next, construct taxonomy-based tree available annotations. ensure ancestor descendant nodes remain uniquely identifiable, add prefixes taxonomic level (e.g., p_ phylum, f_ family). Without step, different levels can share names, prevent taxonomy converted valid tree. prefixed taxonomy table passed taxonomy_to_tree(), producing hierarchical tree serve backbone visualization. point, two aligned objects ready visualization: normalized abundance matrix (x) taxonomy-derived tree (tree). now pass objects phylobar(). resulting plot shows stacked bar charts taxa abundances, aligned hierarchical tree structure.","code":"dietpath <- tempfile(fileext = \".rda\") download.file(\"https://go.wisc.edu/l68i2z\", dietpath, mode = \"wb\") diet <- get(load(dietpath))  diet #> phyloseq-class experiment-level object #> otu_table()   OTU Table:         [ 119 taxa and 38 samples ] #> sample_data() Sample Data:       [ 38 samples by 8 sample variables ] #> tax_table()   Taxonomy Table:    [ 119 taxa by 3 taxonomic ranks ] diet_mstat <- mStat_convert_phyloseq_to_data_obj(diet) diet_mstat <- mStat_normalize_data(diet_mstat, \"DESeq\") x <- t(diet_mstat$data.obj.norm$feature.tab) taxa <- tax_table(diet) taxa[, 1] <- add_prefix(\"p_\", taxa[, 1]) taxa[, 2] <- add_prefix(\"f_\", taxa[, 2]) taxa <- cbind(Kingdom = \"k_Bacteria\", taxa) tree <- taxonomy_to_tree(taxa) phylobar(x, tree, width=800)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/diet_analysis.html","id":"interpretation","dir":"Articles","previous_headings":"","what":"Interpretation","title":"Diet Data","text":"showcase several notable patterns using screenshots interactive plots: mice display co-dominance Firmicutes (purple) Bacteroidetes (teal), sample_52 shows clear Firmicutesremotes::install_github(“author/LUPINE”) dominance, underscoring dietary interventions can shift balance two phyla.  Next, observe abundance Clostridium cluster IV family acros samples. variability abundance suggests Clostridium cluster IV widespread, contribution community structure differs across individuals conditions.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/diet_analysis.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Diet Data","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] MicrobiomeStat_1.4.1        tibble_3.3.0                #>  [3] rlang_1.1.6                 DESeq2_1.48.2               #>  [5] SummarizedExperiment_1.38.1 Biobase_2.68.0              #>  [7] MatrixGenerics_1.20.0       matrixStats_1.5.0           #>  [9] GenomicRanges_1.60.0        GenomeInfoDb_1.44.3         #> [11] IRanges_2.42.0              S4Vectors_0.46.0            #> [13] BiocGenerics_0.54.0         generics_0.1.4              #> [15] phylobar_0.99.0             phangorn_2.12.1             #> [17] ape_5.8-1                   htmlwidgets_1.6.4           #> [19] phyloseq_1.52.0             BiocStyle_2.36.0            #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3      jsonlite_2.0.0          magrittr_2.0.4          #>   [4] farver_2.1.2            nloptr_2.2.1            rmarkdown_2.30          #>   [7] fs_1.6.6                ragg_1.5.0              vctrs_0.6.5             #>  [10] multtest_2.64.0         minqa_1.2.8             ggtree_3.16.3           #>  [13] htmltools_0.5.8.1       S4Arrays_1.8.1          Rhdf5lib_1.30.0         #>  [16] SparseArray_1.8.1       rhdf5_2.52.1            gridGraphics_0.5-1      #>  [19] sass_0.4.10             bslib_0.9.0             desc_1.4.3              #>  [22] plyr_1.8.9              cachem_1.1.0            igraph_2.1.4            #>  [25] lifecycle_1.0.4         iterators_1.0.14        pkgconfig_2.0.3         #>  [28] Matrix_1.7-4            R6_2.6.1                fastmap_1.2.0           #>  [31] clue_0.3-66             GenomeInfoDbData_1.2.14 rbibutils_2.3           #>  [34] digest_0.6.37           numDeriv_2016.8-1.1     aplot_0.2.9             #>  [37] ggnewscale_0.5.2        spatial_7.3-18          patchwork_1.3.2         #>  [40] textshaping_1.0.3       vegan_2.7-1             httr_1.4.7              #>  [43] abind_1.4-8             mgcv_1.9-3              compiler_4.5.1          #>  [46] withr_3.0.2             pander_0.6.6            S7_0.2.0                #>  [49] BiocParallel_1.42.2     MASS_7.3-65             rappdirs_0.3.3          #>  [52] DelayedArray_0.34.1     biomformat_1.36.0       fBasics_4041.97         #>  [55] permute_0.9-8           tools_4.5.1             glue_1.8.0              #>  [58] quadprog_1.5-8          stabledist_0.7-2        nlme_3.1-168            #>  [61] rhdf5filters_1.20.0     grid_4.5.1              cluster_2.1.8.1         #>  [64] reshape2_1.4.4          ade4_1.7-23             gtable_0.3.6            #>  [67] tidyr_1.3.1             data.table_1.17.8       XVector_0.48.0          #>  [70] rmutil_1.1.10           foreach_1.5.2           pillar_1.11.1           #>  [73] stringr_1.5.2           yulab.utils_0.2.1       splines_4.5.1           #>  [76] dplyr_1.1.4             treeio_1.32.0           lattice_0.22-7          #>  [79] survival_3.8-3          tidyselect_1.2.1        locfit_1.5-9.12         #>  [82] Biostrings_2.76.0       knitr_1.50              reformulas_0.4.1        #>  [85] bookdown_0.44           ggtreeExtra_1.18.1      xfun_0.53               #>  [88] timeDate_4041.110       stringi_1.8.7           UCSC.utils_1.4.0        #>  [91] lazyeval_0.2.2          ggfun_0.2.0             yaml_2.3.10             #>  [94] boot_1.3-32             evaluate_1.0.5          codetools_0.2-20        #>  [97] timeSeries_4041.111     BiocManager_1.30.26     ggplotify_0.1.3         #> [100] cli_3.6.5               rpart_4.1.24            systemfonts_1.2.3       #> [103] Rdpack_2.6.4            jquerylib_0.1.4         Rcpp_1.1.0              #> [106] stable_1.1.6            parallel_4.5.1          modeest_2.4.0           #> [109] pkgdown_2.1.3           ggplot2_4.0.0           lme4_1.1-37             #> [112] tidytree_0.4.6          lmerTest_3.1-3          scales_1.4.0            #> [115] statip_0.2.3            purrr_1.1.0             crayon_1.5.3            #> [118] fastmatch_1.1-6"},{"path":"https://mkdiro-o.github.io/phylobar/articles/exporting.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Exporting to SVG","text":"identify interesting view, can share others? First, press Escape key freeze view, doesn’t respond mouse interactions. , always take screenshot, want preserve details (add notes within figure ), instead export Scalable Graphics (SVG), discussed vignette. work, need use Google Chrome install bookmarklet SVG Crowbar 2. ’ll illustrate process using simple randomly generatred tree .","code":"library(ape) library(phylobar) #> Loading required package: phyloseq #> Loading required package: htmlwidgets #> Loading required package: phangorn  tree <- rtree(20) samples <- matrix(rpois(100 * 20, 1), 100, 20) phylobar(samples, tree, width=800)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/exporting.html","id":"step-1-exporting-from-browser","dir":"Articles","previous_headings":"","what":"Step 1: Exporting from Browser","title":"Exporting to SVG","text":"bookmarklet installed, can press download phylobar figures Quarto Rmarkdown notebook. recording , pressed Escape painting blue subtree. move bookmarks bar without changing view. Clicking bookmarklet brings “SVG # (Download)” button can click, associated graphic appear Downloads folder. Note can scroll phylobar visualizations see buttons downloading plots.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/exporting.html","id":"step-2-open-in-editor","dir":"Articles","previous_headings":"","what":"Step 2: Open in Editor","title":"Exporting to SVG","text":"downloaded file ordinary SVG, means can edited image editor designed vector graphics. example, recording , open downloaded figure using Inkscape, free open source vector graphics editor. Notice components phylobar plot already organized layers.. example, layer barplot, sublayers sample, final sublayer taxa within samples. layer structure reflects original DOM structure created D3 visualization code. recording shows can navigate layer structure within Inkscape.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/exporting.html","id":"step-3-modify-and-save","dir":"Articles","previous_headings":"","what":"Step 3: Modify and Save","title":"Exporting to SVG","text":", edit want (e.g., add comment interesting pattern). able export formats might accessible others, e.g., one can embed slides add word document. recording , use layer structure shown previous snippet modify green subtree uses dashed (rather solid) lines link nodes. final version, export graphic PNG format.","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] phylobar_0.99.0   phangorn_2.12.1   htmlwidgets_1.6.4 phyloseq_1.52.0   #> [5] ape_5.8-1         BiocStyle_2.36.0  #>  #> loaded via a namespace (and not attached): #>  [1] ade4_1.7-23             tidyselect_1.2.1        dplyr_1.1.4             #>  [4] farver_2.1.2            Biostrings_2.76.0       S7_0.2.0                #>  [7] fastmap_1.2.0           digest_0.6.37           lifecycle_1.0.4         #> [10] cluster_2.1.8.1         survival_3.8-3          magrittr_2.0.4          #> [13] compiler_4.5.1          rlang_1.1.6             sass_0.4.10             #> [16] tools_4.5.1             igraph_2.1.4            yaml_2.3.10             #> [19] data.table_1.17.8       knitr_1.50              plyr_1.8.9              #> [22] RColorBrewer_1.1-3      purrr_1.1.0             BiocGenerics_0.54.0     #> [25] desc_1.4.3              grid_4.5.1              stats4_4.5.1            #> [28] multtest_2.64.0         biomformat_1.36.0       Rhdf5lib_1.30.0         #> [31] ggplot2_4.0.0           scales_1.4.0            iterators_1.0.14        #> [34] MASS_7.3-65             cli_3.6.5               rmarkdown_2.30          #> [37] vegan_2.7-1             crayon_1.5.3            ragg_1.5.0              #> [40] generics_0.1.4          httr_1.4.7              reshape2_1.4.4          #> [43] cachem_1.1.0            rhdf5_2.52.1            stringr_1.5.2           #> [46] splines_4.5.1           parallel_4.5.1          BiocManager_1.30.26     #> [49] XVector_0.48.0          vctrs_0.6.5             Matrix_1.7-4            #> [52] jsonlite_2.0.0          bookdown_0.44           IRanges_2.42.0          #> [55] S4Vectors_0.46.0        systemfonts_1.2.3       foreach_1.5.2           #> [58] jquerylib_0.1.4         glue_1.8.0              pkgdown_2.1.3           #> [61] codetools_0.2-20        stringi_1.8.7           gtable_0.3.6            #> [64] GenomeInfoDb_1.44.3     UCSC.utils_1.4.0        quadprog_1.5-8          #> [67] tibble_3.3.0            pillar_1.11.1           htmltools_0.5.8.1       #> [70] rhdf5filters_1.20.0     GenomeInfoDbData_1.2.14 R6_2.6.1                #> [73] textshaping_1.0.3       evaluate_1.0.5          lattice_0.22-7          #> [76] Biobase_2.68.0          bslib_0.9.0             Rcpp_1.1.0              #> [79] fastmatch_1.1-6         nlme_3.1-168            permute_0.9-8           #> [82] mgcv_1.9-3              xfun_0.53               fs_1.6.6                #> [85] pkgconfig_2.0.3"},{"path":"https://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Global Patterns Dataset Examples","text":"","code":"library(phylobar) library(phyloseq) library(miaViz) library(scater)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"phyloseq-inputs","dir":"Articles","previous_headings":"","what":"phyloseq Inputs","title":"Global Patterns Dataset Examples","text":"first study use phylobar phyloseq objects. block sets global pattern status subsets Chlamydia subtree. can extract relevant sample composition using otu_table accessor function.","code":"data(GlobalPatterns, package = \"phyloseq\") chlamydiae <- subset_taxa(GlobalPatterns, Phylum == \"Chlamydiae\") x_phylo <- t(otu_table(chlamydiae))"},{"path":"https://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"phylogenetic-tree-tree","dir":"Articles","previous_headings":"phyloseq Inputs","what":"Phylogenetic Tree Tree","title":"Global Patterns Dataset Examples","text":"first approach use phylogenetic tree support hierarchical interaction. tree can extracted phyloseq object using phy_tree. first subsetted chlamydia subtree. now samples without observed counts. Therefore, remove samples view. can now create phylobar plot.","code":"tree_phylo <- phy_tree(chlamydiae) x_phylo <- x_phylo[rowSums(x_phylo) > 0, ] x_phylo <- x_phylo / rowSums(x_phylo) phylobar(x_phylo, tree_phylo, width = 900)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"using-taxonomic-hierarchy","dir":"Articles","previous_headings":"phyloseq Inputs","what":"Using Taxonomic Hierarchy","title":"Global Patterns Dataset Examples","text":"creates type visualization using taxonomic hierarchy rather phylogeny. need problem-specific preprocessing deal fact ancestor descendant names look identical dataset. add_prefix helper ensures names distinct parents children adding taxonomic rank name. Now can create phylo tree object associated original taxonomy. Note binary tree, since several taxonomic categories descended single node.  Given new taxonomy earlier sample information, can now create phylobar plot.","code":"taxa <- tax_table(chlamydiae) |>     as.data.frame() taxa$ASV <- rownames(taxa) taxa <- phylobar::add_prefix(taxa) tax_tree <- taxonomy_to_tree(taxa) plot(tax_tree) phylobar(x_phylo, tax_tree, width = 900)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/global_patterns.html","id":"treesummarizedexperiment-inputs","dir":"Articles","previous_headings":"","what":"TreeSummarizedExperiment Inputs","title":"Global Patterns Dataset Examples","text":"example comes miaViz documentation shows create stacked bar tree TreeSummarizedExperiment. ’ll filter species present least one percent samples. example ’ll use relative abundance transformation, left composition plot rather general stacked bar plot. Let’s keep taxes observed least one sample. also need filter tree reflect reduced subset taxa. inputs, can generate phylobar visualization. view didn’t subset chlamydia class, larger tree . hopefully ’s clear TreeSummarizedExperiment phyloseq can essentially used interchangeably constructing necessary inputs visualizations.","code":"data(GlobalPatterns, package = \"mia\") prev_species <- getPrevalent(GlobalPatterns, rank = \"Species\", detection = 0.01) GlobalPatterns_tse <- GlobalPatterns[     rowData(GlobalPatterns)$Species %in% prev_species, ] GlobalPatterns_tse <- transformAssay(     GlobalPatterns_tse,      method = \"relabundance\" ) x_tse <- t(assay(GlobalPatterns_tse, \"relabundance\")) x_tse <- x_tse[, colSums(x_tse) > 0] tree_tse <- rowTree(GlobalPatterns_tse) |>     keep.tip(colnames(x_tse)) phylobar(x_tse, tree_tse, width = 900) sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] scater_1.35.0                   scuttle_1.18.0                  #>  [3] miaViz_1.16.0                   mia_1.16.0                      #>  [5] TreeSummarizedExperiment_2.16.1 Biostrings_2.76.0               #>  [7] XVector_0.48.0                  SingleCellExperiment_1.30.1     #>  [9] MultiAssayExperiment_1.34.0     SummarizedExperiment_1.38.1     #> [11] Biobase_2.68.0                  GenomicRanges_1.60.0            #> [13] GenomeInfoDb_1.44.3             IRanges_2.42.0                  #> [15] S4Vectors_0.46.0                BiocGenerics_0.54.0             #> [17] generics_0.1.4                  MatrixGenerics_1.20.0           #> [19] matrixStats_1.5.0               ggraph_2.2.2                    #> [21] ggplot2_4.0.0                   phylobar_0.99.0                 #> [23] phangorn_2.12.1                 ape_5.8-1                       #> [25] htmlwidgets_1.6.4               phyloseq_1.52.0                 #>  #> loaded via a namespace (and not attached): #>   [1] splines_4.5.1               ggplotify_0.1.3             #>   [3] tibble_3.3.0                cellranger_1.1.0            #>   [5] polyclip_1.10-7             DirichletMultinomial_1.50.0 #>   [7] lifecycle_1.0.4             lattice_0.22-7              #>   [9] MASS_7.3-65                 SnowballC_0.7.1             #>  [11] magrittr_2.0.4              sass_0.4.10                 #>  [13] rmarkdown_2.30              jquerylib_0.1.4             #>  [15] yaml_2.3.10                 DBI_1.2.3                   #>  [17] RColorBrewer_1.1-3          ade4_1.7-23                 #>  [19] abind_1.4-8                 quadprog_1.5-8              #>  [21] purrr_1.1.0                 fillpattern_1.0.2           #>  [23] yulab.utils_0.2.1           tweenr_2.0.3                #>  [25] rappdirs_0.3.3              GenomeInfoDbData_1.2.14     #>  [27] ggrepel_0.9.6               tokenizers_0.3.0            #>  [29] irlba_2.3.5.1               tidytree_0.4.6              #>  [31] vegan_2.7-1                 rbiom_2.2.1                 #>  [33] parallelly_1.45.1           pkgdown_2.1.3               #>  [35] permute_0.9-8               DelayedMatrixStats_1.30.0   #>  [37] codetools_0.2-20            DelayedArray_0.34.1         #>  [39] ggtext_0.1.2                xml2_1.4.0                  #>  [41] ggforce_0.5.0               tidyselect_1.2.1            #>  [43] aplot_0.2.9                 UCSC.utils_1.4.0            #>  [45] farver_2.1.2                ScaledMatrix_1.16.0         #>  [47] viridis_0.6.5               jsonlite_2.0.0              #>  [49] BiocNeighbors_2.2.0         multtest_2.64.0             #>  [51] decontam_1.28.0             tidygraph_1.3.1             #>  [53] survival_3.8-3              iterators_1.0.14            #>  [55] emmeans_1.11.2-8            systemfonts_1.2.3           #>  [57] foreach_1.5.2               tools_4.5.1                 #>  [59] ggnewscale_0.5.2            treeio_1.32.0               #>  [61] ragg_1.5.0                  Rcpp_1.1.0                  #>  [63] glue_1.8.0                  gridExtra_2.3               #>  [65] SparseArray_1.8.1           BiocBaseUtils_1.10.0        #>  [67] xfun_0.53                   mgcv_1.9-3                  #>  [69] dplyr_1.1.4                 withr_3.0.2                 #>  [71] fastmap_1.2.0               rhdf5filters_1.20.0         #>  [73] bluster_1.18.0              digest_0.6.37               #>  [75] rsvd_1.0.5                  gridGraphics_0.5-1          #>  [77] R6_2.6.1                    estimability_1.5.1          #>  [79] textshaping_1.0.3           tidyr_1.3.1                 #>  [81] data.table_1.17.8           DECIPHER_3.4.0              #>  [83] graphlayouts_1.2.2          httr_1.4.7                  #>  [85] S4Arrays_1.8.1              pkgconfig_2.0.3             #>  [87] gtable_0.3.6                S7_0.2.0                    #>  [89] janeaustenr_1.0.0           htmltools_0.5.8.1           #>  [91] biomformat_1.36.0           scales_1.4.0                #>  [93] ggfun_0.2.0                 knitr_1.50                  #>  [95] tzdb_0.5.0                  reshape2_1.4.4              #>  [97] coda_0.19-4.1               nlme_3.1-168                #>  [99] cachem_1.1.0                rhdf5_2.52.1                #> [101] stringr_1.5.2               parallel_4.5.1              #> [103] vipor_0.4.7                 desc_1.4.3                  #> [105] pillar_1.11.1               grid_4.5.1                  #> [107] vctrs_0.6.5                 slam_0.1-55                 #> [109] BiocSingular_1.24.0         beachmat_2.24.0             #> [111] xtable_1.8-4                cluster_2.1.8.1             #> [113] beeswarm_0.4.0              evaluate_1.0.5              #> [115] readr_2.1.5                 mvtnorm_1.3-3               #> [117] cli_3.6.5                   compiler_4.5.1              #> [119] rlang_1.1.6                 crayon_1.5.3                #> [121] tidytext_0.4.3              plyr_1.8.9                  #> [123] fs_1.6.6                    ggbeeswarm_0.7.2            #> [125] stringi_1.8.7               viridisLite_0.4.2           #> [127] BiocParallel_1.42.2         lazyeval_0.2.2              #> [129] Matrix_1.7-4                hms_1.1.3                   #> [131] patchwork_1.3.2             sparseMatrixStats_1.20.0    #> [133] Rhdf5lib_1.30.0             gridtext_0.1.5              #> [135] igraph_2.1.4                memoise_2.0.1               #> [137] bslib_0.9.0                 ggtree_3.16.3               #> [139] fastmatch_1.1-6             readxl_1.4.5"},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"High-fat, high-sugar (HFHS) diets known profoundly alter gut microbiome, influencing microbial composition functional capacity. described Susin et al. (2020), effects diet gut microbiome evaluated 47 C57BL/6 female mice. mice fed either HFHS diet normal diet, fecal samples collected days 0, 1, 4, 7. Illumina MiSeq used generate 16S rRNA sequencing data, subsequently processed QIIME 1.9.0. vignette, use preprocessed dataset Kodikara et al. (2025). dataset can accessed GitHub repository LUPINE R package using command devtools::install_github(\"SarithaKodikara/LUPINE\"). , demonstrate apply phylobar package create phylogeny-aware visualizations HFHS diet study data. Specifically, walk tree construction generate visualizations reproduce key findings previous studies, including decreased relative abundance increase relative abundance (Jo et al. 2021, Yang et al. 2024).","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"why-phylogeny-aware-plots","dir":"Articles","previous_headings":"","what":"Why phylogeny-aware plots?","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"Static stacked bar plots often hide changes occur specific taxonomic levels. Phylogeny-aware plots maintain hierarchical structure, zooming level (example, class Bacteroidia family S24-7) lets see whether shifts local clade spread across multiple branches. supports exploratory analysis helps decide levels warrant downstream testing.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"following code block loads packages required analysis. Next, load HFHS dataset, stored LUPINE package HFHSdata. dataset stored list contains OTU tables mice fed either normal diet HFHS diet, along corresponding taxonomic annotations.","code":"library(phylobar)   # phylogeny-aware bar plots library(LUPINE)     # HFHS example dataset library(dplyr)      # data wrangling library(ape)        # phylogenetic tree manipulation library(stringr)    # string operations data(HFHSdata) normal <- HFHSdata$OTUdata_Normal hfhs <- HFHSdata$OTUdata_HFHS taxa <- HFHSdata$filtered_taxonomy"},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"taxonomy-based-tree-construction","dir":"Articles","previous_headings":"","what":"Taxonomy-based tree construction","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"begin constructing taxonomy-based tree taxonomic annotations provided dataset. taxonomy_to_tree function phylobar package used convert taxonomic data phylogenetic tree structure.","code":"tree <- taxa |>     select(-X1, X1) |>     mutate(         across(             everything(),              ~if_else(str_ends(., \"_\"), NA, .)         )     ) |>     taxonomy_to_tree()  checkValidPhylo(tree) #> Starting checking the validity of tree... #> Found number of tips: n = 212  #> Found number of nodes: m = 80  #> Done."},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"diet-contrasts-on-day-7","dir":"Articles","previous_headings":"","what":"Diet contrasts on day 7","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"visualize effect diet mouse microbiome, focus samples collected day 7. samples expected show pronounced differences normal diet HFHS diet group (Kodikara et al. 2025). begin extracting relevant slices 3D arrays representing OTU tables diet groups. also rename samples indicate diet group (N normal diet H HFHS diet). Finally convert compositions visualize. Lets select Bacteroidia class dropdown see effect diet class.","code":"# Extract day 7 samples and rename normal_day7 <- normal[,, 4] rownames(normal_day7) <- str_replace(rownames(normal_day7), \"M_\", \"N\") hfhs_day7 <- hfhs[,, 4] rownames(hfhs_day7) <- str_replace(rownames(hfhs_day7), \"M_\", \"H\") # Combine the two datasets all_day7 <- rbind(normal_day7, hfhs_day7)  # Order samples and species using hierarchical clustering comp_norm <- normal_day7 comp_norm <- comp_norm / rowSums(comp_norm) sample_order1 <- hclust(dist(comp_norm))$order species_order <- hclust(dist(t(comp_norm)))$order  # Now order the HFHS samples  comp_hfhs <- hfhs_day7 comp_hfhs <- comp_hfhs / rowSums(comp_hfhs) sample_order2 <- hclust(dist(comp_hfhs))$order   # Combine the sample orders sample_order <- c(rownames(normal_day7)[sample_order1], rownames(hfhs_day7)[sample_order2])  # Reorder the combined data x <- all_day7[sample_order, species_order] comp <- x / rowSums(x) colnames(comp) <- colnames(all_day7)[species_order] phylobar(comp, tree, hclust_order = FALSE, sample_font_size = 9)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"interpretation","dir":"Articles","previous_headings":"Diet contrasts on day 7","what":"Interpretation","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"Phylobar plot mouse microbiome day 7, comparing normal diet (N) HFHS diet (H). plot highlights relative abundances Bacteroidia class, known decrease response HFHS diet. shown Figure @ref(fig:fig1), relative abundance Bacteroidia decreases HFHS diet group compared normal diet group, consistent previous findings (Jo et al. 2021, Yang et al. 2024). Similarly, can visualize Firmicutes phylum observe increase relative abundance HFHS diet (Figure @ref(fig:fig2)). Phylobar plot mouse microbiome day 7, comparing normal diet (N) HFHS diet (H). plot highlights relative abundances Firmicutes phylum, known increase response HFHS diet.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"longitudinal-trajectories-within-hfhs","dir":"Articles","previous_headings":"","what":"Longitudinal trajectories within HFHS","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"explore longitudinal patterns HFHS diet group, visualized samples collected days 0, 1, 4, 7. allows us track microbiome composition changes time response HFHS diet. Samples deliberately sorted mouse time point, enabling us observe within-mouse changes across study period. important initial relative abundances can differ mice, aligning samples individual helps highlight true longitudinal shifts. now convert compositions visualize longitudinal data HFHS diet group.","code":"y <- hfhs[sample_order2, species_order, ] |>     aperm(c(1, 3, 2)) |>     matrix(nrow = nrow(hfhs)*dim(hfhs)[3] , ncol = ncol(hfhs))  rownames(y) <- apply(     expand.grid(c(0, 1, 4, 7), str_replace(rownames(hfhs),\"M_\",\"\")[sample_order2]),     1, paste, collapse = \"-\" ) comp <- y / rowSums(y) colnames(comp) <- colnames(hfhs)[species_order] phylobar(comp, tree, hclust_order = FALSE, sample_font_size = 9) #p<-phylobar(comp, tree, hclust_order = FALSE, width=1200, height = 800, sample_font_size = 8) #htmlwidgets::saveWidget(p, \"interactive_scatter.html\", selfcontained = TRUE)"},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"interpretations","dir":"Articles","previous_headings":"Longitudinal trajectories within HFHS","what":"Interpretations","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"Even though variability mice high, can observe general decrease relative abundance S24-7 family (within Bacteroidetes phylum) time response HFHS diet (Figure @ref(fig:fig3)). pattern aligns previous findings indicating members S24-7 family sensitive dietary changes tend decrease abundance high-fat, high-sugar dietary conditions (Kodikara et al. 2025). Phylobar plot mouse microbiome HFHS diet. plot highlights relative abundances S24-7 family belong Bacteroidetes phylum, known decrease time response HFHS diet.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/articles/hfhs.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"The effect of a high-fat high-sugar (HFHS) diet on the mouse microbiome","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Chicago #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] stringr_1.5.2     dplyr_1.1.4       LUPINE_0.1.0      phylobar_0.99.0   #> [5] phangorn_2.12.1   ape_5.8-1         htmlwidgets_1.6.4 phyloseq_1.52.0   #> [9] BiocStyle_2.36.0  #>  #> loaded via a namespace (and not attached): #>   [1] Rdpack_2.6.4            pbapply_1.7-4           gridExtra_2.3           #>   [4] permute_0.9-8           rlang_1.1.6             magrittr_2.0.4          #>   [7] ade4_1.7-23             NetworkDistance_0.3.6   matrixStats_1.5.0       #>  [10] e1071_1.7-16            compiler_4.5.1          mgcv_1.9-3              #>  [13] png_0.1-8               systemfonts_1.2.3       vctrs_0.6.5             #>  [16] reshape2_1.4.4          quadprog_1.5-8          pkgconfig_2.0.3         #>  [19] crayon_1.5.3            fastmap_1.2.0           XVector_0.48.0          #>  [22] rmarkdown_2.30          influential_2.2.9       pracma_2.4.4            #>  [25] UCSC.utils_1.4.0        graphon_0.3.6           ragg_1.5.0              #>  [28] network_1.19.0          purrr_1.1.0             xfun_0.53               #>  [31] cachem_1.1.0            GenomeInfoDb_1.44.3     jsonlite_2.0.0          #>  [34] biomformat_1.36.0       rhdf5filters_1.20.0     BiocParallel_1.42.2     #>  [37] Rhdf5lib_1.30.0         parallel_4.5.1          cluster_2.1.8.1         #>  [40] R6_2.6.1                bslib_0.9.0             stringi_1.8.7           #>  [43] RColorBrewer_1.1-3      rlist_0.4.6.2           jquerylib_0.1.4         #>  [46] Rcpp_1.1.0              bookdown_0.44           iterators_1.0.14        #>  [49] knitr_1.50              ROptSpace_0.2.4         IRanges_2.42.0          #>  [52] Matrix_1.7-4            splines_4.5.1           igraph_2.1.4            #>  [55] tidyselect_1.2.1        abind_1.4-8             yaml_2.3.10             #>  [58] vegan_2.7-1             doParallel_1.0.17       codetools_0.2-20        #>  [61] lattice_0.22-7          tibble_3.3.0            plyr_1.8.9              #>  [64] withr_3.0.2             rARPACK_0.11-0          Biobase_2.68.0          #>  [67] S7_0.2.0                coda_0.19-4.1           evaluate_1.0.5          #>  [70] desc_1.4.3              survival_3.8-3          proxy_0.4-27            #>  [73] Biostrings_2.76.0       pillar_1.11.1           BiocManager_1.30.26     #>  [76] foreach_1.5.2           stats4_4.5.1            ellipse_0.5.0           #>  [79] generics_0.1.4          S4Vectors_0.46.0        ggplot2_4.0.0           #>  [82] scales_1.4.0            class_7.3-23            glue_1.8.0              #>  [85] tools_4.5.1             data.table_1.17.8       RSpectra_0.16-2         #>  [88] fs_1.6.6                fastmatch_1.1-6         rhdf5_2.52.1            #>  [91] grid_4.5.1              tidyr_1.3.1             rbibutils_2.3           #>  [94] nlme_3.1-168            GenomeInfoDbData_1.2.14 cli_3.6.5               #>  [97] textshaping_1.0.3       mixOmics_6.32.0         corpcor_1.6.10          #> [100] gtable_0.3.6            sass_0.4.10             digest_0.6.37           #> [103] BiocGenerics_0.54.0     ggrepel_0.9.6           farver_2.1.2            #> [106] htmltools_0.5.8.1       pkgdown_2.1.3           multtest_2.64.0         #> [109] lifecycle_1.0.4         httr_1.4.7              statnet.common_4.12.0   #> [112] MASS_7.3-65"},{"path":"https://mkdiro-o.github.io/phylobar/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kris Sankaran. Author, maintainer, funder. Megan Kuo. Author.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sankaran K, Kuo M (2025). phylobar: Interactive construction stacked barplots using hierarchies. R package version 0.99.0, https://github.com/mkdiro-O/phylobar.","code":"@Manual{,   title = {phylobar: Interactive construction of stacked barplots using hierarchies},   author = {Kris Sankaran and Megan Kuo},   year = {2025},   note = {R package version 0.99.0},   url = {https://github.com/mkdiro-O/phylobar}, }"},{"path":"https://mkdiro-o.github.io/phylobar/index.html","id":"phylobar","dir":"","previous_headings":"","what":"Interactive construction of stacked barplots using hierarchies","title":"Interactive construction of stacked barplots using hierarchies","text":"phylobar visualization package makes possible construct stacked barplot interactively “painting” associated tree. alternative defining color palette using fixed taxonomic resolution. also helps avoid issue grouping rare taxa color “” – since species can chosen selectively, can paint rare taxa rest (see quickstart recording). main plotting function, phylobar, takes two inputs, table potentially normalized counts tree structure, can come either phylogeny table taxonomic assignments. See vignettes examples converting alternative data formats (e.g., phyloseq) input format. can export interactive snapshot SVG file using SVG crowbar package illustrated “Exporting Views” vignettes.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Interactive construction of stacked barplots using hierarchies","text":"can install development version phylobar using:","code":"remotes::install_packages(\"mkdir-o/phylobar\")"},{"path":"https://mkdiro-o.github.io/phylobar/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Interactive construction of stacked barplots using hierarchies","text":"block applies phylobar small random data set:  GitHub doesn’t allow us include interactive blocks within README, recording . can interact output link. Clicking node collapses subtree. Double clicking introduces new color. freeze view, press spacebar.","code":"library(ape) library(phylobar)  tree <- rtree(20) samples <- matrix(rpois(100 * 20, 1), 100, 20) phylobar(samples, tree)"},{"path":"https://mkdiro-o.github.io/phylobar/index.html","id":"common-tasks","dir":"","previous_headings":"","what":"Common Tasks","title":"Interactive construction of stacked barplots using hierarchies","text":"Building tree taxonomy: Rather interacting abstract phylogenetic trees can helpful choose stacked bar color using taxonomic assignments. vignette gets quick overview constructing trees taxonomy tables, including checks make sure input formatted properly. Exporting views: interactivity useful exploration, often need export specific static view discuss others. vignette gives alternative simple screenshots preserves image quality supports, editing software like illustrator inkscape. Customizing style: Phylobar supports styling customizations, like changing size text labels color palette. vignette walks currently available options. Subsetting representative samples: Stacked bar plots can cumbersome many samples (e.g., > 1000) present, bars become thin. vignette includes helper functions create views representative samples.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"Interactive construction of stacked barplots using hierarchies","text":"full function reference can found page.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/index.html","id":"learn-more","dir":"","previous_headings":"","what":"Learn More","title":"Interactive construction of stacked barplots using hierarchies","text":"fully developed data analysis examples can found following vignettes. ’ve included small screen recordings showing views can helpful tasks like quality control, intergroup comparison, longitudal analysis. design package inspired focus-plus-context principle data visualization. paper gives -depth discussion, classics area include (). package implemented using wonderful htmlwidgets package linking javascript. js code phylobar available npm phylobar-js.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"Interactive construction of stacked barplots using hierarchies","text":"can reach us creating Issue package repository sending email ksankaran@wisc.edu. appreciate trying package try best reply promptly.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":null,"dir":"Reference","previous_headings":"","what":"Add rank prefixes to taxonomic matrix values. — add_prefix","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"value taxonomic matrix (except last column), adds prefix based first character column (rank) name. example, column \"Genus\", prefix \"G_\".","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"","code":"add_prefix(taxa)"},{"path":"https://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"taxa character matrix columns representing taxonomic ranks rows representing taxa.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"character matrix prefixes added value (except last column).","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/add_prefix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add rank prefixes to taxonomic matrix values. — add_prefix","text":"","code":"taxa <- matrix(   c(\"Firmicutes\", \"Bacilli\", \"Lactobacillales\",     \"Proteobacteria\", \"Gammaproteobacteria\", \"Enterobacterales\"),   ncol = 3, byrow = TRUE,   dimnames = list(NULL, c(\"Phylum\", \"Class\", \"Order\")) ) add_prefix(taxa) #>      Phylum             Class                   Order              #> [1,] \"P_Firmicutes\"     \"C_Bacilli\"             \"Lactobacillales\"  #> [2,] \"P_Proteobacteria\" \"C_Gammaproteobacteria\" \"Enterobacterales\""},{"path":"https://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"Takes two column matrix (parents -> descendants) constructs ape phylo object .","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"","code":"edgelist_to_phylo(edgelist)"},{"path":"https://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"edgelist two-column matrix row represents parent-descendant relationship.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"object class 'phylo' representing tree structure.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/edgelist_to_phylo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert an edge list to an ape phylo object. — edgelist_to_phylo","text":"","code":"# Example edge list: parent -> child edgelist <- matrix(   c(\"A\", \"B\",     \"A\", \"C\",     \"B\", \"D\",     \"B\", \"E\"),   ncol = 2, byrow = TRUE,   dimnames = list(NULL, c(\"parent\", \"child\")) ) tree <- edgelist_to_phylo(edgelist) str(tree) #> List of 4 #>  $ edge      : int [1:4, 1:2] 4 4 5 5 5 1 2 3 #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:4] \"A\" \"A\" \"B\" \"B\" #>   .. ..$ : NULL #>  $ tip.label : chr [1:3] \"C\" \"D\" \"E\" #>  $ node.label: chr [1:2] \"A\" \"B\" #>  $ Nnode     : int 2 #>  - attr(*, \"class\")= chr \"phylo\""},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct Initial Hierarchy — node_hierarchy","title":"Construct Initial Hierarchy — node_hierarchy","text":"reshapes list output node_totals hierarchical format needed d3 tree visualization.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct Initial Hierarchy — node_hierarchy","text":"","code":"node_hierarchy(tree, totals, node = NULL)"},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct Initial Hierarchy — node_hierarchy","text":"tree object class phylo, representing tree structure. totals named list node totals, returned node_totals. node Name node start recursion. Defaults root node.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct Initial Hierarchy — node_hierarchy","text":"nested list representing hierarchy, node containing ' name, value, summary, children ().","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_hierarchy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct Initial Hierarchy — node_hierarchy","text":"","code":"library(ape) set.seed(1) tree <- rtree(5) x_mat <- matrix(runif(15), ncol = 5) colnames(x_mat) <- tree$tip.label  totals <- node_totals(tree, x_mat) node_hierarchy(tree, totals) #> Error in map(children_nodes, ~node_hierarchy(tree, totals, .x)): ℹ In index: 1. #> Caused by error in `matrix()`: #> ! 'data' must be of a vector type, was 'NULL'"},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Node Totals — node_totals","title":"Compute Node Totals — node_totals","text":"loops internal nodes tree takes sum descendant taxa, sample.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Node Totals — node_totals","text":"","code":"node_totals(tree, x_mat)"},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Node Totals — node_totals","text":"tree object class phylo, representing tree structure. Must tip labels matching columns x_mat. x_mat numeric matrix abundances, samples rows features (tips) columns. Column names correspond tree tip","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Node Totals — node_totals","text":"named list element corresponds internal node (node label) contains vector totals sample, computed summing abundances descendant tips.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/node_totals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Node Totals — node_totals","text":"","code":"library(ape) set.seed(1) tree <- rtree(5) x_mat <- matrix(runif(15), ncol = 5) colnames(x_mat) <- tree$tip.label node_totals(tree, x_mat) #> list()"},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":null,"dir":"Reference","previous_headings":"","what":"Tree + Stacked Bars — phylobar","title":"Tree + Stacked Bars — phylobar","text":"phylobar visualization package makes possible construct stacked barplot interactively \"painting\" associated tree. alternative defining color palette using fixed taxonomic resolution. also helps avoid issue grouping rare taxa color \"\" since species can chosen selectively, can paint rare taxa rest.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tree + Stacked Bars — phylobar","text":"","code":"phylobar(   x,   tree,   hclust_order = TRUE,   palette = NULL,   width = NULL,   height = NULL,   sample_font_size = 8,   sample_label_margin = 10,   sample_label_space = 50,   sample_magnify = 1.5,   sample_show_all = TRUE,   element_id = NULL,   rel_width = 0.4,   rel_height = 0.85,   rel_space = 10,   legend_mode = TRUE,   legend_x_start = 5,   legend_spacing = 16 )"},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tree + Stacked Bars — phylobar","text":"x matrix abundances. Samples along rows, features along columns. tree object class phylo, representing tree structure. hclust_order Logical; TRUE, reorder rows/columns hierarchical clustering. palette Character vector colors stacked bars. NULL, uses default palette: c(\"#9c7bbaff\", \"#6eb8acff\", \"#ce7b7bff\", \"#7b9cc4ff\", \"#c47ba0ff\", \"#e1d07eff\"). width Width widget pixels. NULL, uses window default. height Height widget pixels. NULL, uses window default. sample_font_size Font size sample labels (integer). sample_label_margin Margin sample labels bars pixels. sample_label_space Space allocated sample labels pixels. sample_magnify Magnification factor hovered sample labels. sample_show_all Logical; TRUE, show sample labels. element_id Optional HTML element ID attach widget . rel_width Width tree panel relative overall visualization. Defaults 0.4. rel_height Relative height tree overall visualization. Defaults 0.85. Adjust need /less space legend. rel_space Space tree barplot panels pixels. legend_mode Logical; TRUE (default), display labels painted subtrees legend near bottom tree.  FALSE, include labels within tree . legend_x_start Horizontal starting position (pixels) legend. Defaults 4. legend_spacing Vertical spacing (pixels) legend entries.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tree + Stacked Bars — phylobar","text":"htmlwidget visualization attached element element_id output HTML page.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tree + Stacked Bars — phylobar","text":"","code":"library(ape) set.seed(1) tree <- rtree(5) x <- matrix(rpois(15), ncol = 5) #> Error in rpois(15): argument \"lambda\" is missing, with no default phylobar(x, tree) #> Error: object 'x' not found"},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare tree data for phylobar visualization — phylobar_data","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"Prepare tree data phylobar visualization","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"","code":"phylobar_data(x, tree, hclust_order = TRUE)"},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"x matrix abundances. Samples along rows, features along columns. tree n object class phylo, representing tree structure. hclust_order Logical; TRUE, reorder rows/columns hierarchical clustering.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"list tree_data labels.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/phylobar_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare tree data for phylobar visualization — phylobar_data","text":"","code":"library(ape) set.seed(1) tree <- rtree(5) x <- matrix(runif(15), nrow = 3) colnames(x) <- tree$tip.label rownames(x) <- paste0(\"sample\", 1:3) phylobar_data(x, tree) #> Error in if (tree$node.label[1] == \"\") {    tree$node.label[1] <- \"root\"}: argument is of length zero"},{"path":"https://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Subsample rows of a matrix using hierarchical clustering — subset_cluster","title":"Subsample rows of a matrix using hierarchical clustering — subset_cluster","text":"function takes matrix x subsamples rows clustering using hierarchical clustering. One representative row selected cluster, helps visualizing large dataset semi-representative way.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subsample rows of a matrix using hierarchical clustering — subset_cluster","text":"","code":"subset_cluster(x, k = 100)"},{"path":"https://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subsample rows of a matrix using hierarchical clustering — subset_cluster","text":"x matrix whose rows clustered subsampled. k number clusters form (default 100).","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subsample rows of a matrix using hierarchical clustering — subset_cluster","text":"matrix containing one representative row cluster.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/subset_cluster.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subsample rows of a matrix using hierarchical clustering — subset_cluster","text":"","code":"mat <- matrix(rnorm(1000), nrow = 100) result <- subset_cluster(mat, k = 10) #> Error in tapply(rownames(x), clusters, function(k) k[1]): arguments must have same length dim(result) # only 10 representatives #> Error: object 'result' not found"},{"path":"https://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"Creates phylo taxonomic tree, skipping NA assignments. Assumes columns sorted coarsest finest taxonomic resolution.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"","code":"taxonomy_to_tree(taxa)"},{"path":"https://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"taxa data.frame matrix columns representing taxonomic ranks (sorted coarsest finest) rows representing taxa. NA empty values skipped.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"object class 'phylo' representing taxonomic tree.","code":""},{"path":"https://mkdiro-o.github.io/phylobar/reference/taxonomy_to_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a taxonomic table to an ape phylo object. — taxonomy_to_tree","text":"","code":"taxa <- matrix(   c(\"Firmicutes\", \"Bacilli\", \"Lactobacillales\",     \"Proteobacteria\", \"Gammaproteobacteria\", \"Enterobacterales\"),   ncol = 3, byrow = TRUE,   dimnames = list(NULL, c(\"Phylum\", \"Class\", \"Order\")) ) tree <- taxonomy_to_tree(taxa) str(tree) #> List of 4 #>  $ edge      : int [1:4, 1:2] 3 4 5 6 4 1 6 2 #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:4] \"Firmicutes\" \"Bacilli\" \"Proteobacteria\" \"Gammaproteobacteria\" #>   .. ..$ : NULL #>  $ tip.label : chr [1:2] \"Lactobacillales\" \"Enterobacterales\" #>  $ node.label: chr [1:4] \"Firmicutes\" \"Bacilli\" \"Proteobacteria\" \"Gammaproteobacteria\" #>  $ Nnode     : int 4 #>  - attr(*, \"class\")= chr \"phylo\"  # A more involved example with missing values taxa <- matrix(   c(\"Firmicutes\", \"Bacilli\", \"Lactobacillales\", \"ASV1\",     \"Proteobacteria\", \"Gammaproteobacteria\", \"Enterobacterales\", \"ASV2\",     \"Firmicutes\", \"Bacilli\", NA, \"ASV3\"),   ncol = 4, byrow = TRUE,   dimnames = list(NULL, c(\"Phylum\", \"Class\", \"Order\", \"ASV\")) ) taxmat <- add_prefix(taxa) tree <- taxonomy_to_tree(taxmat) str(tree) #> List of 4 #>  $ edge      : int [1:7, 1:2] 4 5 6 7 8 9 5 5 6 1 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:7] \"P_Firmicutes\" \"C_Bacilli\" \"O_Lactobacillales\" \"P_Proteobacteria\" ... #>   .. ..$ : NULL #>  $ tip.label : chr [1:3] \"ASV1\" \"ASV2\" \"ASV3\" #>  $ node.label: chr [1:6] \"P_Firmicutes\" \"C_Bacilli\" \"O_Lactobacillales\" \"P_Proteobacteria\" ... #>  $ Nnode     : int 6 #>  - attr(*, \"class\")= chr \"phylo\""},{"path":"https://mkdiro-o.github.io/phylobar/news/index.html","id":"phylobar-0990","dir":"Changelog","previous_headings":"","what":"phylobar 0.99.0","title":"phylobar 0.99.0","text":"Initial Bioconductor submission.","code":""}]
